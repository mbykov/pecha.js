{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"electron\"","webpack:///external \"lodash\"","webpack:///./src/lib/tibetan_data.js","webpack:///external \"path\"","webpack:////home/michael/sband/dist/index.js","webpack:///external \"debug\"","webpack:///external \"electron-settings\"","webpack:///external \"electron-is-dev\"","webpack:///external \"pouchdb\"","webpack:///../src/index.js","webpack:///external \"electron-clipboard-extended\"","webpack:///external \"slash\"","webpack:///external \"split.js\"","webpack:///external \"util\"","webpack:///../../src/lib/data.js","webpack:///external \"pouchdb-authentication\"","webpack:///external \"mousetrap\"","webpack:///external \"json5\"","webpack:///external \"axios\"","webpack:///./src/lib/utils.js","webpack:///./src/lib/parsedata.js","webpack:///./src/lib/dict.js","webpack:///./src/lib/auth.js","webpack:///./src/lib/nav.js","webpack:///./src/app.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","__webpack_exports__","tibsyms","tibsuff","tsek","default","_","coderanges","console","log","zho","tib","grc","str","code","re","RegExp","test","clean","trim","replace","wopunct","split","join","rep","rows","spans","map","row","forEach","spns","rclause","spn","text","punct","push","clauses","compact","clause","span","lang","cumul","result","syms","segs","seg","sym","letter","lower","vowel","length","space","shad","segments","idx","trl","data","debug","tmp","res","stack","main","prefix","pref","getLetter","voiced","nasalHigh","apref","maa","a","superfix","asuperfix","amain","maintak","_amain","wasur","subfix","asub","asubtak","up2rows","sama","includes","pretty","vow","mainvow","suffix","avow","asuf","kanapamara","tanalasa","umlaut","tasa","secsuf","asecsuf","quest","translit","point","prefs","sufs","ult","penult","vows","indexVow","errs","isWasur","lowers","subfixes","yaralaa","indexSubfix","indWasur","firstLow","indexFirstLow","lowLast","indexLowLast","Error","ralasa","syllable","_lodash","_data","kanatanapamaaralasa","sa","la","u","1","2","3","4","5","col","descr","q","sel","document","querySelector","qs","querySelectorAll","tag","style","el","createElement","classList","add","textContent","empty","hasChildNodes","removeChild","lastChild","getCoords","getBoundingClientRect","placePopup","coords","top","left","getInnermostHovered","slice","pop","settings","remote","showText","state","pars","osource","oresult","opar","ospan","appendChild","showCholok","cumulative","trnanscript","cholok","ncoords","otrans","remove","showPopup","compound","chains","JSON","parse","dataset","err","upper","closest","oul","oambi","body","bottom","createPopup","oline","ambi","stringify","docs","showCompound","chain","owf","showAmbi","queryDBs","retsek","query","lastsek","last","ipcRenderer","send","on","event","parsePhrase","hideProgress","cloneErr","progress","showActiveDicts","cfg","dnames","cf","mess","otable","dict","dname","otr","odt","capitalize","firstdict","oactive","active","check","checkmark","activedict","ocsv","csv","setAttribute","rdbs","defaults","locals","installed","uniq","concat","rdb","osize","size","oink","clone","showRemoteDicts","navigate","section","path","PouchDB","plugin","app","upath","getAppPath","getPath","Mousetrap","getCurrentWindow","history","hstate","hideAll","sectionId","showSection","old","sizes","mono","collapse","setSizes","set","Split","gutterSize","cursor","minSize","onDragEnd","reload","addEventListener","ev","twoPanes","sections","Array","which","goLeft","goRight","csvpath","serverAuth","skip_setup","localpath","resolve","sync","live","retry","signUp","response","then","signup","scrollPane","axios","clipboard","dialog","container","link","import","cloneNode","oldver","newver","over","verTxt","catch","error","shiftKey","delta","deltaY","opane","scrollTop","scanDir","fns","datapath","importCSV","target","parent","parentElement","contains","href","shell","openExternal","find","rest","reject","unshift","moveDictFirst","activateDict","id","showOpenDialog","properties","filters","extensions","ctrlKey","popup","wf","doc","weight","sortBy","odict","odname","oarticle","trns","trn","showResults","ohover","sband","txt","readText","startWatching"],"mappings":"aACA,IAAAA,EAAA,GAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,GAAA,CACAG,EAAAH,EACAI,GAAA,EACAH,QAAA,IAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,IAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,EAAA,CAA0CK,YAAA,EAAAC,IAAAL,KAK1CZ,EAAAkB,EAAA,SAAAhB,GACA,oBAAAiB,eAAAC,aACAN,OAAAC,eAAAb,EAAAiB,OAAAC,YAAA,CAAwDC,MAAA,WAExDP,OAAAC,eAAAb,EAAA,cAAiDmB,OAAA,KAQjDrB,EAAAsB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAArB,EAAAqB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFA1B,EAAAkB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAArB,EAAAU,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAzB,EAAA6B,EAAA,SAAA1B,GACA,IAAAS,EAAAT,KAAAqB,WACA,WAA2B,OAAArB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD/B,EAAAkC,EAAA,GAIAlC,IAAAmC,EAAA,oBClFAhC,EAAAD,QAAAkC,QAAA,2BCAAjC,EAAAD,QAAAkC,QAAA,wCCAApC,EAAAU,EAAA2B,EAAA,sBAAAC,IAAAtC,EAAAU,EAAA2B,EAAA,sBAAAE,IAEO,MAAMD,EAAU,CACrBE,KAAM,KAUKD,EAAU,CAAC,KAAM,IAAK,KAAM,KAAM,KAAM,IAAK,qBCb1DpC,EAAAD,QAAAkC,QAAA,sCCEAtB,OAAOC,eAAeb,EAAS,aAAc,CAC3CmB,OAAO,IAETnB,EAAQuC,aAAU,EAElB,IAAIC,EAAIN,EAAQ,GAiBZO,GAfMC,QAAQC,IAENT,EAAQ,EAARA,CAAiB,OAaZ,CACfU,IAAO,WACPC,IAAO,WACPC,IAAO,qBAgDT9C,EAAQuC,QA5CO,SAAkBQ,EAAKC,GACpC,IAAIC,EAAK,IAAIC,OAAOT,EAAWO,IAC/B,GAAKC,EAAGE,KAAKJ,GAAb,CACA,IAAIK,EAAQL,EAAIM,OAAOC,QAAQ,KAAM,KACjCC,EAAUH,EAAMI,MAAM,KAAKC,KAAK,IACpC,GAAKR,EAAGE,KAAKI,GAAb,CACA,IAAIG,EAAM,IAAIR,OAfH,eAgBPS,EAAOP,EAAME,QAAQ,SAAU,MAAME,MAAM,MAI3CI,GAHWD,EAAKE,IAAI,SAAUC,GAChC,OAAOA,EAAIN,MAAME,KAEP,IA8BZ,OA7BAC,EAAKI,QAAQ,SAAUD,GACrB,IAAIE,EAAO,GACIF,EAAIN,MAAME,GAChBK,QAAQ,SAAUE,GACzB,GAAIP,EAAIP,KAAKc,GAAU,CACrB,IAAIC,EAAM,CACRC,KAAMF,EACNG,OAAO,GAETJ,EAAKK,KAAKH,OACL,CACL,IAAII,EAAUL,EAAQT,MAAMP,IAC5BqB,EAAU9B,EAAE+B,QAAQD,IACZP,QAAQ,SAAUS,GAExB,GADAA,EAASA,EAAOnB,OAChB,CACA,IACIoB,EAAO,CACTN,KAAMK,KAFGvB,EAAGE,KAAKqB,KAITC,EAAKC,KAAO1B,GAGtBgB,EAAKK,KAAKI,SAIhBb,EAAMS,KAAKL,KAENJ,oBCxET3D,EAAAD,QAAAkC,QAAA,wBCAAjC,EAAAD,QAAAkC,QAAA,qCCAAjC,EAAAD,QAAAkC,QAAA,kCCAAjC,EAAAD,QAAAkC,QAAA,oGCMe,SAAAa,EAAA4B,GACb,IAAIC,EAAJ,GAWA,OAsTF,SAAA7B,GACE,IAAI8B,EAAO9B,QAAX,IACI+B,EAAJ,GACIC,EAAJ,GACAF,UAAa,SAAAG,GACX,GAAIC,aAAeC,QAAfD,IAA6BE,QAAjCH,GACED,cACK,CACDA,EAAJK,QAAgBN,OAAU,CAACjC,IAAXiC,IAChBC,KACA,IAAIM,SACaA,EAAbL,GAAO1C,EAAXA,KAA0B,CAAC+C,MAA3B,KACSL,GAAOM,EAAXA,KAA0B,CAACD,MAA3B,KACQ,CAACA,MAATA,GACLP,aAGAC,EAAJK,QAAgBN,OAAU,CAACjC,IAAXiC,IAChB,OAAAA,EAlVWS,CAAXxC,GACA+B,QAAa,SAAAC,EAAAS,GACX,GAAIT,EAAJlC,IAAa,CACX,IACI4C,EA8JV,SAAAC,EAAAf,GAEE,GADAgB,aACID,OAAJN,OACE,wBAEF,IAiJFrC,EACM6C,EAlJAC,EAAJ,GACIC,EAAJ,GACIC,SACJ,GAAIL,EAAJM,OAAiB,CACf,IAAIC,EAAOhB,SAAOS,EAAlBM,QAGA,IADAD,EAAOG,EAAUR,EAAjBK,OACIA,IAAeA,MAAWI,SAAOJ,EAArCjC,KACSiC,UAAiBA,MAArB,IAAmCA,MAAWK,YAAUL,EAArBA,MACxC,IAAIM,EAAQ,CAACJ,EAADR,IAAA,MAAAhC,KAAZ,IACI6C,eAAaZ,EAAjBM,UACED,MAAW,KAAMA,EAANN,KAAAhC,KADkB,KAI7B4C,EADEE,KAAKb,EAATM,OACU,CAACC,EAADR,IAAA,KAAAhC,KAAR4C,IAEQ,CAACJ,EAADR,IAAA,MAAAhC,KAAR4C,IAEEX,eAAJ,KAA0BA,SAAkBK,MAf7B,KAgBfD,UAGF,GAAIJ,EAAJc,SAAmB,CACjB,IAAIA,EAAWvB,SAAOS,EAAtBc,UACIC,EAAY,CAACD,EAADf,IAAA,KAAAhC,KAAhB,IACAqC,UAEA,IAsHJ/C,EAvHoB2C,EAAhBK,KAwHEH,EAAKV,QAATnC,GAxHEgD,EA0HFH,EAAepD,gBAAfoD,GACW,CAACH,IAAPI,IA1HCE,IAAeA,MAAWI,SAAOJ,EAArCjC,KACK,GAAIiC,QAAeA,MAAWK,YAAUL,EAArBA,MACxB,IAAIW,EAAQ,CAACX,EAADN,IAAA,KAAAhC,KAAZ,IACIkD,EAAU,CAAAC,EAAA,OAAAnD,KAAd,IACAqC,UACIU,YAAJ,KAA2BT,QAAiBA,MAV3B,WAYjBA,IAAWA,EAAOG,EAAUR,EAAjBK,OAGbF,SACA,IAAIa,EAAQ,CAACX,EAADN,IAAA,KAAAhC,KAAZ,IAKA,GAJAqC,UAEIJ,EAAJmB,OAAgBf,gBAEZJ,EAAJoB,OAAiB,CACf,IAAIA,EAAS5B,QAAMQ,EAAnBoB,QACIC,EAAO,CAACD,EAADrB,IAAA,KAAAhC,KAAX,IACIuD,EAAU,CAAAD,EAAA,OAAAtD,KAAd,IACAqC,UACA,KAAIJ,SACF,GAAIK,OACFF,WAAeoB,UAAQlB,EAAvBF,KACIH,eAAJ,KAA0BA,SACxBK,YAGFF,WAAe,CAACA,OAADJ,IAAeqB,EAAfrB,KAAAhC,KAAfoC,IAEG,KAAIH,WACT,KAAIA,OAAkBG,WAAtB,KACKA,gBACL,KAAIH,WACAwB,gBAAcxB,EAAlBK,OAEW,MAAAoB,SAAepB,EAAnBjC,OACL+B,iBAGJC,OAAWsB,EAAXtB,IAGF,GAAIJ,EAAJ2B,IAAc,CACZ,IAAIA,EAAM7E,gBAAQ2C,QAAMO,EAAxB2B,MACAvB,OAAWuB,EAAXvB,OACIJ,oBAAsBA,QAAqBA,EAA/CoB,SAA4Df,MAHhD,IAIZ,IAAIuB,EAAU,CAACvB,EAADN,IAAW4B,EAAX5B,KAAAhC,KAAd,IACAoC,QACAC,eAEAD,MAAU,CAACJ,IAAXI,KAEF,GAAIH,EAAJ6B,OAAiB,CACf,IAAIA,EAASrB,EAAUR,EADR6B,QAIf,GAFA1B,WAEIH,EAAJ8B,KAAe,CACb,IAAIA,EAAOrC,QAAMO,EAAjB8B,MACA7B,8BACID,UAAea,EAAnBA,IACEV,WACAC,OAAWD,SAAXC,KACAA,OAAW0B,EAAX1B,OACAA,OAAW0B,EAAX1B,KACA,KAAI0B,MACF3B,kBAEAA,aAAiB2B,EAAjB3B,KAGJF,cACAA,WAAgByB,EAAhBzB,QACK,CACL,IAAI8B,EAAO,CAACF,EAAD9B,IAAA,KAAAhC,KAAX,IACA,GAAIiE,sBAAoBhC,EAAxB6B,cAEO,GAAII,oBAAkBjC,EAAtB6B,QACL1B,UAAc+B,SAAO/B,MAAP+B,MAAuB/B,MAArCA,QACK,IAAIU,KAAKb,EAAT6B,OAGL,0BAFAE,EAAOF,EAAPE,IAIF3B,UAIF,GADI+B,gBAAcnC,EAAlB6B,UAAgC1B,eAC5BH,EAAJoC,OAAiB,CACf,IAAIA,EAAS7C,SAAOS,EAApBoC,QACIC,EAAU,CAACD,EAADrC,IAAA,KAAAhC,KAAd,IACAqC,UAEFA,OAAWsB,EAAXtB,IAGF,IAAIL,EAAOd,EAASmB,OAAV,KAA4BsB,EAAtCvB,GAGA,OAFIH,EAAJsC,QAAgBvC,EAAM,CAAAA,EAAMC,QAAND,KAAAhC,KAANgC,KAChBA,EAAMA,iCAlIuB,KA9JfwC,CAShB,SAAAlD,GACE,IAuUFC,EAvUMkD,SACArD,EAAOE,EAAXlC,IACIkD,SACAC,SAAQQ,SAAU2B,EAAtB,GACIZ,SAAQO,SAAQN,SAChBY,EAAJ,GACIJ,SAEAK,EAAM7F,eAAVqC,GACIyD,EAASzD,EAAKA,SAAlB,GA8TFG,EA5TEqD,EA6TO7F,eAAO2C,EAAP3C,gBAAPwC,GA5TMuB,KAAJ+B,IACEd,IACA3C,SAEOyD,GAAU/B,EAAV+B,GAAeD,GAAO/B,MAA1B,KACLzB,QACAA,QACAmD,EAAQ,CAACvC,IAATuC,OAGF,IAAIO,EAAO/F,yBAAqBA,eAAO2C,EAAvCA,QACIkC,SAAKmB,SACT,MAAID,SAAkBlB,EAAMkB,EAANlB,GAAemB,EAAW3D,UAAhDwC,QACK,GAAIkB,SAAJ,EAAqB,MAAO,CAACE,KAAM,CAAd,oBAE1B,IAAIC,EAAU7D,WAAcgC,EAA5BA,OAEI8B,EAASnG,yBAAqBA,eAAO0C,EAAzCA,QACI0D,EAAWpG,yBAAqBqG,EAApCA,SACI/B,SAAQgC,SAGZ,GAFA,GAAIF,WAAsB9B,EAAS8B,EAAT9B,GAAsBgC,EAAcjE,UAApCiC,IAE1B4B,EAAa,CACX,IAAIK,EAAWlE,UAAagC,EAA5BA,OACAqB,UACAnC,EAAOlB,EAAKkE,EAAZhD,GACAC,EAASnB,EAAKkE,EAAd/C,GACAoC,EAAOvD,QAAWkE,EAAlBX,QACK,GAAIO,EAAJvD,OAAmB,CACxB8C,IACA,IAAIc,EAAWL,EAAf,GACIM,EAAgBpE,UAApBmE,GAEA,GADAb,EAAQtD,UAARsD,GACId,GAAJP,EACEoB,aACApB,EAASjC,EAAK2D,EAAd1B,GACAf,EAAOlB,EAAK2D,EAAZzC,GACAoC,EAAQtD,UAAc2D,EAAtBL,GACAC,EAAOvD,QAAW2D,EAAlBJ,QACK,GAAAf,EACLa,IACAnC,EAAOlB,EAAK2D,EAAZzC,GACAoC,EAAQtD,UAAc2D,EAAtBL,GACAC,EAAOvD,QAAW2D,EAAlBJ,QACK,GAAAtB,EACLoB,QACAnC,EAAOlB,EAAKiE,EAAZ/C,GACAoC,EAAQtD,UAAciE,EAAtBX,GACAC,EAAOvD,QAAWiE,EAAlBV,OACK,CACLF,IACA,IAAIgB,EAAUP,YAAd,GACIQ,EAAetE,UAAnBqE,GACAnD,EAAOlB,EAAPkB,GACAoC,EAAQtD,UAARsD,GACAC,EAAOvD,QAAWsE,EAAlBf,SAEG,GAAAtB,EACLoB,IACAnC,EAAOlB,EAAKiE,EAAZ/C,GACAoC,EAAQtD,UAAciE,EAAtBX,GAEEC,EADFf,EACSxC,QAAW2D,EAAlBJ,GAEOvD,QAAWiE,EAAlBV,GAEU7B,EAAZA,OAGA,GAAAc,EACEa,IACAnC,EAAOlB,EAAK2D,EAAZzC,GACAoC,EAAQtD,UAAc2D,EAHf,GAIPJ,EAAOvD,QAAW2D,EAAlBJ,GACY7B,EAAZA,MAEK,CAEL,GADA2B,IACIrD,SAAJ,EAAqB,MAAM,IAAAuE,MAAN,6BACrB,GAAIvE,SAAkBkB,EAAOlB,EAA7B,GACK,GAAIA,UACPqD,IACAnC,EAAOlB,EAAPkB,GACAwB,EAAS1C,EAAT0C,IACS1C,aAAJ,GAAwBA,WAC7BqD,IACAlC,EAASnB,EAATmB,GACAD,EAAOlB,EAAPkB,GACAqC,EAAOvD,QAAPuD,IAKFD,GAASA,EAAb/C,SACE,GAAI+C,UACFnC,EAASmC,EAATnC,GACIqD,kBAAgBlB,EAApB,MAA+B3B,EAAW2B,EAAX3B,KAGxB2B,GAAJ,GAAaA,WACZkB,kBAAgBlB,EAApB,IAA+B3B,EAAW2B,EAA1C,GACKnC,EAASmC,EAATnC,KAILoC,GAAQA,EAAZhD,SACE,GAAIgD,UAAkBb,EAASa,EAATb,GAAkBO,EAASM,EAAjD,IACK,GAAIA,WAAkBb,EAASa,EAATb,KAG7B,IAAI7B,EAAO,CAACwC,MAADA,EAAelC,OAAfA,EAA+BQ,SAA/BA,EAAmDT,KAAnDA,EAA+De,OAA/DA,EAA+EO,IAA/EA,EAAyFE,OAAzFA,EAAyGO,OAAzGA,EAAyHW,KAAzH,GAAmI5D,KAAnIA,GAKX,IAAK,IAALpD,KAJAiH,IAAahD,YACb8B,IAAU9B,UACVsC,IAAWtC,WAEXA,EACOA,EAALjE,WAAuBiE,EAAPjE,GAiBlB,OAfI0G,GAASA,SAAb,GACEzC,8BAGEkD,SAAJ,GACElD,iCAGE0C,SAAJ,GACE1C,iCAEFK,GACEL,wBAGFA,EA5Jc4D,CAAVvE,GACAJ,GACAC,eAEAA,OAAYG,EAAZH,SAGGA,OAAP,KAjBF,MAAA2E,EAAAzJ,EAAA,uCACA0J,EAAA1J,EAAA,IACU4C,QAAVC,IAAA,IACIgD,EAAQzD,KAAZ,OA4SA,SAAAkF,EAAAvB,GACOA,EAALwB,MAAcxB,MAAU,CAACJ,IAAXI,MACd,IAAI9C,EAAM8C,OAAVJ,IAGA,OAFA1C,EAAM,CAAAA,EAAM8C,MAANJ,KAAAhC,KAANV,IACI8C,EAAJ0B,SAAgBxE,EAAM,CAAAA,EAAM8C,SAANJ,KAAAhC,KAANV,KAChBA,EAGF,SAAAmD,EAAAnD,GACE,IAAI6C,EAAMX,SAAVlC,GAIA,OAFA6C,EAAepD,gBAAfoD,GACW,CAACH,IAAPI,mBC5TP5F,EAAAD,QAAAkC,QAAA,8CCAAjC,EAAAD,QAAAkC,QAAA,yBCAAjC,EAAAD,QAAAkC,QAAA,oCCAAjC,EAAAD,QAAAkC,QAAA,uFCEaI,OAAN,IACMgD,OAAN,IACM+D,SAAS,SAAf,KAEMI,sBAAsB,qCAA5B,KACM/B,aAAa,iBAAnB,KACMC,WAAW,aAAjB,KACME,OAAO,KAAb,KACM6B,KAAK,CAAX,KACMpD,MAAM,KAAZ,KACMC,IAAN,IACMW,OAAO,KAAb,KACMyC,KAAK,CAAX,KACMd,UAAU,aAAhB,KACMhC,QAAN,IACMe,SAAS,CAACrB,EAAD,IAASqD,EAAT,IAAiBjJ,EAAjB,KACTwF,SAAS,CAAC0D,EAAD,IAASC,EAAT,IAAiBC,EAAjB,IAAyBC,EAAzB,IAAiCC,EAAhD,MACM7D,YAAY,CAACyD,EAAD,IAASC,EAAT,IAAiBC,EAAjB,IAAyBC,EAA3C,KACM/C,UAAU,CAAC4C,EAAD,IAASC,EAAT,KAAkBC,EAAlB,MAA4BC,EAA5C,MAlBA,IAoBM/E,WAAN,GACMC,UAAN,GACMC,UAAN,GACPD,OAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,KAAY3B,IAAZ,EAAoBoG,IAApB,GACbhF,EAAA,KAAa,CAACO,IAAD,MAAa3B,IAAb,EAAqBoG,IAArB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,KAAY3B,IAAZ,EAAoBoG,IAApB,GACbhF,EAAA,KAAa,CAACO,IAAD,MAAa3B,IAAb,EAAqBoG,IAArB,GACbhF,EAAA,KAAa,CAACO,IAAD,KAAY3B,IAAZ,EAAoBoG,IAApB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,KAAY3B,IAAZ,EAAoBoG,IAApB,GACbhF,EAAA,KAAa,CAACO,IAAD,MAAa3B,IAAb,EAAqBoG,IAArB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,KAAY3B,IAAZ,EAAoBoG,IAApB,GACbhF,EAAA,KAAa,CAACO,IAAD,MAAa3B,IAAb,EAAqBoG,IAArB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,KAAY3B,IAAZ,EAAoBoG,IAApB,GACbhF,EAAA,KAAa,CAACO,IAAD,MAAa3B,IAAb,EAAqBoG,IAArB,GAEbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,EAAA,KAAa,CAACO,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACbhF,MAAY,CAACO,IAAD,GAAU3B,IAAV,EAAkBoG,IAA9BhF,GACAA,MAAY,CAACO,IAAD,GAAU3B,IAAV,EAAkBoG,IAAK,GAInCjF,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GACAA,OAAc,CAACQ,IAAD,KAAY3B,IAAZ,EAAoBoG,IAAlCjF,GACAA,OAAc,CAACQ,IAAD,MAAa3B,IAAb,EAAqBoG,IAAnCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACdjF,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GACAA,OAAc,CAACQ,IAAD,KAAY3B,IAAZ,EAAoBoG,IAAlCjF,GACAA,OAAc,CAACQ,IAAD,MAAa3B,IAAb,EAAqBoG,IAAnCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACdjF,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GACAA,OAAc,CAACQ,IAAD,KAAY3B,IAAZ,EAAoBoG,IAAlCjF,GACAA,OAAc,CAACQ,IAAD,MAAa3B,IAAb,EAAqBoG,IAAnCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACdjF,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GACAA,OAAc,CAACQ,IAAD,KAAY3B,IAAZ,EAAoBoG,IAAlCjF,GACAA,OAAc,CAACQ,IAAD,MAAa3B,IAAb,EAAqBoG,IAAnCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GAEdjF,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GACAA,OAAc,CAACQ,IAAD,KAAY3B,IAAZ,EAAoBoG,IAAlCjF,GACAA,OAAc,CAACQ,IAAD,MAAa3B,IAAb,EAAqBoG,IAAnCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GAEAA,OAAc,CAACQ,IAAD,KAAY3B,IAAZ,EAAoBoG,IAAlCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACdjF,EAAA,KAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GAEdjF,EAAA,KAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACdjF,EAAA,KAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAnB,GACdjF,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAjCjF,GACAA,OAAc,CAACQ,IAAD,IAAW3B,IAAX,EAAmBoG,IAAK,GAgBtC/E,EAAA,KAAa,CAACM,IAAD,IAAW0E,MAAX,WACbhF,OAAa,CAACM,IAAD,IAAW0E,MAAxBhF,QACAA,OAAa,CAACM,IAAD,IAAW0E,MAAxBhF,UACAA,OAAa,CAACM,IAAD,IAAW0E,MAAxBhF,QACAA,OAAa,CAACM,IAAD,IAAW0E,MAAxBhF,wBC1GAlF,EAAAD,QAAAkC,QAAA,yCCAAjC,EAAAD,QAAAkC,QAAA,4BCAAjC,EAAAD,QAAAkC,QAAA,wBCAAjC,EAAAD,QAAAkC,QAAA,0ECEWA,EAAQ,IAEZ,SAASkI,EAAGC,GACjB,OAAOC,SAASC,cAAcF,GAGzB,SAASG,EAAIH,GAClB,OAAOC,SAASG,iBAAiBJ,GAG5B,SAAS7I,EAAQkJ,EAAKC,GAC3B,IAAIC,EAAKN,SAASO,cAAcH,GAEhC,OADIC,GAAOC,EAAGE,UAAUC,IAAIJ,GACrBC,EAqBF,SAASnG,EAAM1B,EAAK4H,GACzB,IAAIC,EAAKN,SAASO,cAAc,QAGhC,OAFAD,EAAGI,YAAcjI,EACb4H,GAAOC,EAAGE,UAAUC,IAAIJ,GACrBC,EAsBF,SAASK,EAAOL,GACrB,GAAKA,EACL,KAAOA,EAAGM,iBACRN,EAAGO,YAAYP,EAAGQ,WAiCf,SAASC,EAAWT,GAEzB,OADWA,EAAGU,wBAKT,SAASC,EAAYC,EAAQZ,GAClC,IAAIa,EAAM,CAACD,EAAOC,IAAK,MAAMhI,KAAK,IAC9BiI,EAAO,CAACF,EAAOE,KAAM,MAAMjI,KAAK,IACpCmH,EAAGD,MAAMc,IAAMA,EACfb,EAAGD,MAAMe,KAAOA,EAIX,SAASC,IAAwB,MAAO,GAAGC,MAAMvL,KAAKiK,SAASG,iBAAiB,WAAWoB,mDC1GlG,MAAMC,EAAW5J,EAAQ,GAAY6J,OAAO7J,QAAQ,qBAEpD,IAAII,EAAOF,IAAQE,KACnB,MAAMK,EAAMD,QAAQC,IAEb,SAASqJ,EAASC,GACvB,IAAIC,EAAOD,EAAMC,KACbC,EAAU/B,EAAE,WACZgC,EAAUhC,EAAE,WAChBa,EAAMkB,GACNlB,EAAMmB,GAENF,EAAKnI,QAAQH,IACX,IAAIyI,EDoCD,SAAYtJ,EAAK4H,GACtB,IAAIC,EAAKN,SAASO,cAAc,KAGhC,OAFAD,EAAGI,YAAcjI,EACb4H,GAAOC,EAAGE,UAAUC,IAAIJ,GACrBC,ECxCM5I,GACXqK,EAAKvB,UAAUC,IAAI,UACnBnH,EAAMG,QAAQG,IACZ,IAAIoI,EAAQ7H,EAAKP,EAAIC,MACjBD,EAAIQ,KAAM4H,EAAMxB,UAAUC,IAAI,aACzB7G,EAAIE,MAAOkI,EAAMxB,UAAUC,IAAI,SACnCuB,EAAMxB,UAAUC,IAAI,SACzBsB,EAAKE,YAAYD,KAEnBH,EAAQI,YAAYF,KAGZ7B,EAAG,gBAIR,SAASgC,EAAW5B,EAAI6B,GAC7B,IAAIjB,EAASH,EAAUT,GACnB8B,EAAeD,EAAcE,IAAO/B,EAAGI,aAAa,GAAQ2B,IAAO/B,EAAGI,aACtE4B,EAAU,CAACnB,IAAKD,EAAOC,IAAM,GAAIC,KAAMF,EAAOE,KAAO,IACrDmB,EAASzC,EAAE,eACfyC,EAAO7B,YAAc0B,EACrBG,EAAO/B,UAAUgC,OAAO,aACxBvB,EAAWqB,EAASC,GAyCf,SAASE,EAAUnC,EAAIoC,GAC5B,IAAIC,EACJ,IACEA,EAASC,KAAKC,MAAMvC,EAAGwC,QAAQH,QAC/B,MAAMI,GAEN,YADA1K,EAAI,mBAAoBiI,GAG1B,IAAI0C,GAAS1C,EAAG2C,QAAQ,WACpBC,EA3BN,SAAqB5C,EAAI0C,GACvB,IAAIG,EACAH,IACFG,EAAQjM,EAAO,MAAO,UAChBsJ,UAAUC,IAAI,SACpBT,SAASoD,KAAKnB,YAAYkB,IACrBA,EAAQrD,EAAE,SAEjB,IAAIoB,EAASH,EAAUT,GACvBK,EAAMwC,GACNA,EAAM3C,UAAUgC,OAAO,aAEvBvB,EADc,CAACE,IAAKD,EAAOmC,OAAO,EAAGjC,KAAMF,EAAOE,MAC9B+B,GACpB,IAAID,EAAMhM,EAAO,KAAM,YAEvB,OADAiM,EAAMlB,YAAYiB,GACXA,EAYGI,CAAYhD,EAAI0C,GAGtBN,EAiBN,SAAsBQ,EAAKP,GAEzBA,EAAOlJ,QAAQgB,IACb,IAEIuH,EAFAuB,EAAQrM,EAAO,KAAM,YACzBgM,EAAIjB,YAAYsB,GAEZ9I,EAAI+I,MACNxB,EAAQ7H,EAAKM,EAAIA,IAAK,YAChBqI,QAAQH,OAASC,KAAKa,UAAUhJ,EAAIkI,QACjClI,EAAIiJ,KAAK5I,QAClBkH,EAAQ7H,EAAKM,EAAIA,IAAK,UAChBqI,QAAQY,KAAOd,KAAKa,UAAUhJ,EAAIiJ,MAExC1B,EAAQ7H,EAAKM,EAAIA,IAAK,aAExB8I,EAAMtB,YAAYD,KAhCN2B,CAAaT,EAAKP,GAIlC,SAAkBO,EAAKP,GACrBO,EAAI1C,UAAUC,IAAI,UAClBkC,EAAOlJ,QAAQmK,IACb,IAAIL,EAAQrM,EAAO,KAAM,YACzBgM,EAAIjB,YAAYsB,GAChBK,EAAMnK,QAAQgB,IACZ,IAAIoJ,EAAOpJ,EAAIiJ,KAAK5I,OAAUX,EAAKM,EAAIA,IAAK,SAAWN,EAAKM,EAAIA,IAAK,aACjEA,EAAIiJ,KAAK5I,SAAQ+I,EAAIf,QAAQY,KAAOd,KAAKa,UAAUhJ,EAAIiJ,OAC3DH,EAAMtB,YAAY4B,OAXjBC,CAASZ,EAAKP,GAgGd,SAASoB,EAASzD,EAAIoC,GACZ5C,EAAE,aACRU,UAAUgC,OAAO,aAC1B,IAAI3I,EAAOyG,EAAGI,YAAY3H,OACtBiL,EAAS,IAAIpL,OAAOZ,EAAK,KAIzBiM,EAAQ,CAACxL,IAHHoB,EAAKb,QAAQgL,EAAQ,IAGRtB,SAAUA,EAAUwB,QAFhChM,IAAEiM,KAAKtK,IACK7B,GAEvBoM,cAAYC,KAAK,WAAYJ,GAG/BG,cAAYE,GAAG,YAAa,SAAUC,EAAON,GAC5BnE,EAAE,aACRU,UAAUC,IAAI,aACvB,IAAImD,EAAQK,EAAML,MACdtD,EAAKe,IACJuC,IAIDK,EAAMvB,UACRpC,EAAGwC,QAAQH,OAASC,KAAKa,UAAUG,GACnCnB,EAAUnC,GAAI,IA1KX,SAAqBA,EAAIsD,EAAOM,GAChC5D,IACLA,EAAGI,YAAc,GACjBkD,EAAMnK,QAAQ,CAACgB,EAAKS,KAClB,IAAI8G,EACAvH,EAAI+I,MACNxB,EAAQ7H,EAAKM,EAAIA,IAAK,YAChBqI,QAAQH,OAASC,KAAKa,UAAUhJ,EAAIkI,QACjClI,EAAIiJ,KAAK5I,QAClBkH,EAAQ7H,EAAKM,EAAIA,IAAK,UAChBqI,QAAQY,KAAOd,KAAKa,UAAUhJ,EAAIiJ,MAExC1B,EAAQ7H,EAAKM,EAAIA,IAAK,aAExB6F,EAAG2B,YAAYD,GACX9G,EAAM0I,EAAM9I,OAAO,GAAGwF,EAAG2B,YAAY9H,EAAKnC,EAAM,WAElDkM,GAAS5D,EAAG2B,YAAY9H,EAAKnC,EAAM,UA2JlCwM,CAAYlE,EAAIsD,EAAOK,EAAMC,YClNxB9L,QAAQC,IAApB,MACMmJ,EAAW5J,EAAQ,GA8BzB,SAAS6M,EAAalJ,GACpB,IAAImJ,EAAW5E,EAAE,aACb6E,EAAW7E,EAAE,aACbvE,EAAKoJ,EAASnE,UAAUC,IAAI,aAC3BiE,EAASlE,UAAUgC,OAAO,aAoC1B,SAASoC,IACd,IAAIC,EAAMrD,EAAS/K,IAAI,OACnBqO,EAASD,EAAItL,IAAIwL,GAAcA,EAAG5O,MAClC6O,EAAOlF,EAAE,iBACTgF,EAAOhK,SAAQkK,EAAKtE,YAAc,sCACtC,IAAIuE,EAASnF,EAAE,4BACfa,EAAMsE,GACNJ,EAAIpL,QAAQyL,IACV,IAAI/O,EAAO+O,EAAKC,MACZC,EAAMlO,EAAO,MACjB+N,EAAOhD,YAAYmD,GACnB,IAAIC,EAAMnO,EAAO,KAAM,YACvBkO,EAAInD,YAAYoD,GAChBA,EAAI3E,YAAcxI,IAAEoN,WAAWnP,GAC/BkP,EAAIvC,QAAQyC,UAAYpP,EACxB,IAAIqP,EAAUtO,EAAO,KAAM,eAC3B,GAAIgO,EAAKO,OAAQ,CACf,IAAIC,EAAQC,IACZH,EAAQvD,YAAYyD,QAEpBF,EAAQ9E,YAAc,WAExB8E,EAAQ1C,QAAQ8C,WAAazP,EAC7BiP,EAAInD,YAAYuD,GAChB,IAAIK,EAAO3O,EAAO,KAAM,WACxB2O,EAAKnF,YAAc,QACnBmF,EAAK/C,QAAQgD,IAAM3P,EACnBiP,EAAInD,YAAY4D,KAgCpB,SAASF,IACP,IAAID,EAAQxO,EAAO,MAAO,cAE1B,OADAwO,EAAMK,aAAa,MAAO,0BACnBL,EAlITtB,cAAYE,GAAG,mBAAoB,SAAUC,EAAOyB,GAMlDvB,EAAauB,GA8Bf,SAAyBA,GAEvB,IAAInB,EAAMrD,EAAS/K,IAAI,OAEnBwP,EAAW,CAAC,UACZC,EAASrB,EAAItL,IAAI2L,GAAgBA,EAAKC,OACtCgB,EAAYjO,IAAEkO,KAAKH,EAASI,OAAOH,IAEnCjB,EAASnF,EAAE,6BACfa,EAAMsE,GACNe,EAAKvM,QAAQ6M,IACX,GAAIL,EAASpJ,SAASyJ,EAAInB,OAAQ,OAClC,IAAIC,EAAMlO,EAAO,MACjB+N,EAAOhD,YAAYmD,GACnB,IAAIC,EAAMnO,EAAO,MACjBkO,EAAInD,YAAYoD,GAChBA,EAAI3E,YAAcxI,IAAEoN,WAAWgB,EAAInB,OACnC,IAAIoB,EAAQrP,EAAO,KAAM,SACzBqP,EAAM7F,YAAcxI,IAAEoN,WAAWgB,EAAIE,MACrCpB,EAAInD,YAAYsE,GAChB,IAAIE,EAAOvP,EAAO,KAAM,QACxB,GAAIiP,EAAUtJ,SAASyJ,EAAInB,OAAQ,CACjC,IAAIO,EAAQC,IACZc,EAAKxE,YAAYyD,QAEjBe,EAAK/F,YAAc,OAErB+F,EAAK3D,QAAQ4D,MAAQJ,EAAInB,MACzBC,EAAInD,YAAYwE,KAzDlBE,CAAgBX,KAGlB5B,cAAYE,GAAG,iBAAkB,SAAUC,EAAOhJ,GAChDkJ,EAAalJ,GAEbqL,EADY,CAACC,QAAS,kBAIxBzC,cAAYE,GAAG,WAAY,SAAUC,EAAOhJ,GAC1CkJ,EAAalJ,GAEbqL,EADY,CAACC,QAAS,kBAIxBzC,cAAYE,GAAG,eAAgB,SAAUC,EAAOhJ,GAC9CkJ,EAAalJ,GAEbqL,EADY,CAACC,QAAS,iBChCxB,MAAMC,EAAOlP,EAAQ,GAGfS,GADWT,EAAQ,GACbQ,QAAQC,KACd0O,EAAUnP,EAAQ,GACxBmP,EAAQC,OAAOpP,EAAQ,KCGvB,MAAMqP,EAAMxF,SAAOwF,IAEbC,GADQD,EAAIE,aACJF,EAAIG,QAAQ,aAEpB/O,EAAMD,QAAQC,IAEdmJ,GADY5J,EAAQ,IACTA,EAAQ,GAAY6J,OAAO7J,QAAQ,sBAC9CyP,EAAYzP,EAAQ,KAGpB0P,iBAACA,IAFM1P,EAAQ,GACPA,EAAQ,IACKA,EAAQ,GAAY6J,QAG/C,IAEIvI,EAFAqO,EAAU,GACVC,EAAS,EA4FN,SAASZ,EAASjF,GACvB,IACEA,EAAQiB,KAAKC,MAAMD,KAAKa,UAAU9B,IAClC,MAAOoB,GACP1K,EAAI,gBAAiB0K,GACrBpB,EAAQ,GAEV,IAAIkF,EAAUlF,EAAMkF,SAAW,OAC1BA,IAASlF,EAAMkF,QAAU,QAoBhC,SAAqBA,GACnBY,IACA,MAAMC,EAAY,CAAC,IAAKb,GAAS1N,KAAK,IACtC2G,EAAE4H,GAAWlH,UAAUgC,OAAO,aAC9B1C,EAAE4H,GAAWlH,UAAUC,IAAI,YAvB3BkH,CAAYhG,EAAMkF,SAEblF,EAAMiG,MACTjG,EAAMiG,KAAM,SACLjG,EAAMiG,IACbL,EAAQxN,KAAK4H,GACb6F,EAASD,EAAQzM,OAAO,GAEX,QAAX+L,GA1GN,SAAkBlF,GAEhB,IAAIkG,EAAQrG,EAAS/K,IAAI,gBAAkB,CAAC,GAAI,IAC5CyC,GAASyI,EAAMmG,KAAM5O,EAAM6O,SAAS,GAC/B7O,GAAOA,EAAM8O,SAASH,GAE3B3O,IACJsI,EAASyG,IAAI,cAAeJ,GAE5B3O,EAAQgP,IAAM,CAAC,UAAW,WAAY,CACpCL,MAAOA,EACPM,WAAY,EACZC,OAAQ,aACRC,QAAS,CAAC,EAAG,GACbC,UAAW,SAAUT,GACnBrG,EAASyG,IAAI,cAAeJ,GAC5BP,IAAmBiB,YAGnB5G,EAAMmG,MAAM5O,EAAM6O,SAAS,GAE/B/H,SAASwI,iBAAiB,UAAW,SAASC,MAE3C,GAEHzI,SAASwI,iBAAiB,QAAS,SAASC,MAEzC,IA+EoBC,CAAS/G,GAAQD,EAASC,IAC7B,cAAXkF,EAAyBzC,cAAYC,KAAK,cAAe,IAC9C,eAAXwC,GAA0BjC,IAEpB9E,EAAE,aACRU,UAAUC,IAAI,aAGvBe,EAASyG,IAAI,QAAStG,GAUxB,SAAS8F,IAEP,MAAMkB,EAAWzI,EAAG,YACpB0I,MAAMpR,UAAUiC,QAAQ1D,KAAK4S,EAAW9B,IACtCA,EAAQrG,UAAUC,IAAI,aACtBoG,EAAQrG,UAAUgC,OAAO,cAEd1C,EAAE,eACRU,UAAUC,IAAI,aACTX,EAAE,SACRU,UAAUC,IAAI,aAvGtB4G,EAAUjQ,KAAK,CAAC,WAAY,aAAc,SAASqR,GACjC,IAAZA,EAAGI,MAuCT,WACE,GAAIrB,GAAU,EAAG,OACZA,IACL,IAAI7F,EAAQ4F,EAAQC,GACpB7F,EAAMiG,KAAM,EACZH,IACAb,EAASjF,GA7CWmH,GACC,IAAZL,EAAGI,OA+Cd,WACE,GAAIrB,GAAUD,EAAQzM,OAAO,EAAG,OAC3B0M,IACL,IAAI7F,EAAQ4F,EAAQC,GACpB7F,EAAMiG,KAAM,EACZH,IACAb,EAASjF,GArDgBoH,KAG3B1B,EAAUjQ,KAAK,CAAC,QAAS,SAAU,SAASqR,MAK5CpB,EAAUjQ,KAAK,CAAC,OAAQ,SAASqR,MAIjCpB,EAAUjQ,KAAK,CAAC,UAAW,SAASqR,GAElCrE,cAAYC,KAAK,gBADF,0CAIjBgD,EAAUjQ,KAAK,CAAC,UAAW,SAASqR,GAClC,IAAIO,EAAU,+CACd3Q,EAAI,SAAU2Q,GACd5E,cAAYC,KAAK,YAAa2E,KAGhC3B,EAAUjQ,KAAK,CAAC,UAAW,SAASqR,GAClCrE,cAAYC,KAAK,SAAU,aAG7BgD,EAAUjQ,KAAK,CAAC,UAAW,SAASqR,GAClCrE,cAAYC,KAAK,SAAU,cAK7BgD,EAAUjQ,KAAK,CAAC,UAAW,SAASqR,GAClCpQ,EAAI,gBDrFC,SAAgB6O,GACrB,IAAI+B,EAAa,IAAIlC,EAAQ,6BAA8B,CAACmC,YAAY,IACpEC,EAAYrC,EAAKsC,QAAQlC,EAAO,QAAS,QAC/B,IAAIH,EAAQoC,GAClBE,KAAKJ,EAAY,CAACK,MAAM,EAAMC,OAAO,IAAOjF,GAAG,QAASlM,QAAQC,IAAIjB,KAAKgB,UAEjF6Q,EAAWO,OAAO,SAAU,aAAc,SAAUzG,EAAK0G,GACnD1G,IACe,aAAbA,EAAI5M,MAEG4M,EAAI5M,QAOhBuT,KAAK,SAASnO,GACblD,EAAI,aAAckD,KCoEtBoO,CAAOzC,yBC/FT1R,EAAAU,EAAA2B,EAAA,+BAAA+R,KAeA,MAAMpI,EAAW5J,EAAQ,GAAY6J,OAAO7J,QAAQ,qBAI9CiS,GADOjS,EAAQ,IACPA,EAAQ,KAGhBS,GADQT,EAAQ,IACVQ,QAAQC,KAIdyR,GAFOlS,EAAQ,GAEHA,EAAQ,MACpBmS,OAACA,EAAQzC,iBAAgBA,GAAI1P,EAAQ,GAAY6J,OAEzC7J,EAAQ,GAKXkI,EAAE,gBAAb,IACI6E,EAAW7E,EAAE,aAEbkK,EAAYlK,EAAE,cACJI,EAAG,sBACTzG,QAAQwQ,IACd,IACIpD,EADUoD,EAAKC,OACGjK,cAAc,YACpC+J,EAAU/H,YAAY4E,EAAQsD,WAAU,MAG1C/F,cAAYE,GAAG,UAAW,SAAUC,EAAO6F,GACzCP,EAAMpT,IAAI,gEACPiT,KAAK,SAAUD,GACd,IAAKA,IAAaA,EAASrO,KAAM,OACjC,IAAIiP,EAASZ,EAASrO,KAAKjF,KAC3B,GAAIiU,GAAUC,GAAUA,EAASD,EAAQ,CACvC,IAAIE,EAAOxK,EAAE,gBACTyK,EAAS,CAAC,yBAA0BF,GAAQlR,KAAK,KACrDmR,EAAK5J,YAAc6J,EACnBD,EAAK9J,UAAUgC,OAAO,gBAGzBgI,MAAM,SAAUC,GACfrS,QAAQC,IAAI,eAIlB+L,cAAYE,GAAG,UAAW,SAAUC,EAAOsC,GACzCD,EAAS,CAACC,QAASA,MAIrBzC,cAAYE,GAAG,SAAU,SAAUC,GACjC,IAAI5C,EAAQH,EAAS/K,IAAI,SACzB6Q,IAAmBiB,SACnB3B,EAASjF,KAGX,IAAIA,GAAQH,EAAS/K,IAAI,SA2GlB,SAASmT,GAAWnB,EAAI9G,GAC7B,GAAmB,GAAf8G,EAAGiC,SAAkB,OACzB,IAAIC,EAASlC,EAAGmC,OAAS,EAAK,IAAM,GAChCC,EAAQ/K,EAAE,qBACT+K,IACLA,EAAMC,WAAaH,GAGrB,SAASI,GAAQC,GACf,IAAKA,EAAK,OACV,IAAIC,EAAWD,EAAI,GACdC,IACLtG,EAASnE,UAAUgC,OAAO,aAC1B4B,cAAYC,KAAK,gBAAiB4G,IAGpC,SAASC,GAAUF,GACjB,IAAKA,EAAK,OACV,IAAIhC,EAAUgC,EAAI,GACbhC,IACLrE,EAASnE,UAAUgC,OAAO,aAC1B4B,cAAYC,KAAK,kBAAmB2E,IA/HjCrH,KAAOA,GAAQ,CAACkF,QAAS,SAC9BD,EAASjF,IAET3B,SAASwI,iBAAiB,QAAUC,IAElC,IAAIrN,EAAOqN,EAAG0C,OAAOrI,QACrB,IAAK1H,EAAM,OACX,IAAIgQ,EAAS3C,EAAG0C,OAAOE,cACvB,GAAI5C,EAAG0C,OAAO3K,UAAU8K,SAAS,YAAa,CAC5C,IAAIC,EAAO9C,EAAG0C,OAAOzK,YACrB8K,QAAMC,aAAaF,QACVnQ,EAAKyL,QACdD,EAAS,CAACC,QAASzL,EAAKyL,UACfzL,EAAKsL,OACd/B,EAASnE,UAAUgC,OAAO,aAC1B4B,cAAYC,KAAK,YAAajJ,EAAKsL,QAC1BtL,EAAKmK,UHmBX,SAAuBJ,GAC5B,IAAIN,EAAMrD,EAAS/K,IAAI,OACnByO,EAAOhN,IAAEwT,KAAK7G,EAAKK,GAAgBA,EAAKC,OAASA,GACjDwG,EAAOzT,IAAE0T,OAAO/G,EAAKK,GAAgBA,EAAKC,OAASA,GACvDwG,EAAKE,QAAQ3G,IACbL,EAAM8G,GACFlS,QAAQ,CAACyL,EAAMhK,KAASgK,EAAKhK,IAAMA,IACvCsG,EAASyG,IAAI,MAAOpD,GAEpBD,IG3BEkH,CAAc1Q,EAAKmK,WACVnK,EAAKwK,WH6BX,SAAsBtF,GAC3B,IAAIuE,EAAMrD,EAAS/K,IAAI,OACnByO,EAAOhN,IAAEwT,KAAK7G,EAAKK,GAAgBA,EAAKC,OAAS7E,EAAGwC,QAAQ8C,YAC5DF,EAAQC,IACRrF,EAAGI,aACLJ,EAAGI,YAAc,GACjBJ,EAAG2B,YAAYyD,GACfR,EAAKO,QAAS,IAEd9E,EAAML,GACNA,EAAGI,YAAc,WACjBwE,EAAKO,QAAS,GAEhBjE,EAASyG,IAAI,MAAOpD,GGzClBkH,CAAatD,EAAG0C,QACP/P,EAAK0K,KACdnB,EAASnE,UAAUgC,OAAO,aAC1B4B,cAAYC,KAAK,gBAAiBjJ,EAAK0K,MAC9BsF,GAAUA,EAAOtI,SAAWsI,EAAOtI,QAAQ8C,aAG3B,aAAhB6C,EAAG0C,OAAOa,GACnB5H,cAAYC,KAAK,aACQ,WAAhBoE,EAAG0C,OAAOa,GACnBjC,EAAOkC,eAAgB,CAACC,WAAY,CAAC,kBAAoBnB,IAChC,aAAhBtC,EAAG0C,OAAOa,GACnBjC,EAAOkC,eAAe,CAACC,WAAY,CAAC,YAAaC,QAAS,CAAC,CAAChW,KAAM,OAAQiW,WAAY,CAAC,WAAalB,IAC3F9P,EAAKsI,MACdK,EAAS0E,EAAG0C,QAAS,MAIzBnL,SAASwI,iBAAiB,YAAa,SAASC,GAC9C,IAAKA,EAAG0C,OAAOzK,YAAa,OAC5B,GAAkB,GAAd+H,EAAG4D,QAAiB,OACb5D,EAAG0C,OAAOlI,QAAQ,YA6D7B/C,EAAG,UAAUzG,QAAQ6S,IACnBA,EAAM9L,UAAUC,IAAI,eA3DlBgI,EAAG0C,OAAO3K,UAAU8K,SAAS,aACZ,GAAf7C,EAAGiC,UAGL3G,EAAS0E,EAAG0C,QAEL1C,EAAG0C,OAAO3K,UAAU8K,SAAS,SJQnC,SAAqBhL,GACZR,EAAE,WAAhB,IACIgC,EAAUhC,EAAE,WAChBa,EAAMmB,GACN,IAAIyK,EAAKjM,EAAGI,YAERgD,EAAOd,KAAKC,MAAMvC,EAAGwC,QAAQY,MACjC,IACEA,EAAOd,KAAKC,MAAMvC,EAAGwC,QAAQY,MAC7B,MAAMX,GAEN,YADA1K,EAAI,iBAAkB0K,GAIxB,IAAI8B,EAAMrD,EAAS/K,IAAI,OAIvBiN,EAAKjK,QAAQ+S,IAAQA,EAAIC,OAASvU,IAAEwT,KAAK7G,EAAKK,GAAgBsH,EAAIrH,OAASD,EAAKC,OAASjK,MACzFwI,EAAOxL,IAAEwU,OAAOhJ,EAAM,UAGtB,IAAIiJ,EAAQzV,EAAO,MAAO,QAC1B4K,EAAQG,YAAY0K,GACpB,IAAI9I,EAAM3M,EAAO,IAAK,WACtB2M,EAAInD,YAAc6L,EAClBI,EAAM1K,YAAY4B,GAClBH,EAAKjK,QAAQ+S,IACX,IAAII,EAAS1V,EAAO,IAAK,cACzB0V,EAAOlM,YAAc8L,EAAIrH,MACzBwH,EAAM1K,YAAY2K,GAClB,IAAIC,EAAW3V,EAAO,IAAK,gBAC3B2V,EAASnM,YAAc8L,EAAItH,KAC3ByH,EAAM1K,YAAY4K,GAClB,IAAI3J,EAAMhM,EAAO,KAAM,WACvByV,EAAM1K,YAAYiB,GACbsJ,EAAIM,MAAMzU,EAAI,UAAWmU,GACzBA,EAAIM,MACTN,EAAIM,KAAKrT,QAAQsT,IACf,IAAIxJ,EAAQrM,EAAO,KAAM,aACzBqM,EAAM7C,YAAcqM,EACpB7J,EAAIjB,YAAYsB,OIhDlByJ,CAAYvE,EAAG0C,QACN1C,EAAG0C,OAAO3K,UAAU8K,SAAS,YACtC7I,EAAUgG,EAAG0C,UAEd,GAEHnL,SAASwI,iBAAiB,aAAc,SAASC,GAC/C,GAAKA,EAAG0C,OAAO3K,WACG,GAAdiI,EAAG4D,SACH5D,EAAG0C,OAAO3K,UAAU8K,SAAS,aAAc,CAChCxL,EAAE,eACRU,UAAUC,IAAI,gBAEtB,GAEHT,SAASwI,iBAAiB,QAAS,SAASC,GAC1C,GAAkB,GAAdA,EAAG4D,QAAiB,OAEPvM,EAAE,eACRU,UAAUC,IAAI,eACxB,GAEHT,SAASwI,iBAAiB,UAAW,SAASC,GAE5C,GAAmB,GAAfA,EAAGiC,SAAkB,OACzB,IAAIuC,EAAS5L,IACb,IAAK4L,EAAQ,OACI,UAAbA,EAAOjB,KAAgBiB,EAASnN,EAAE,YACtC,IAAIjG,EAAOoT,EAAOvM,YACPwM,IAAMrT,EAAM,SAEvBqI,EAAW+K,GACO,GAAdxE,EAAG4D,SAAiBnK,EAAW+K,GAAQ,MAC1C,GAEHjN,SAASwI,iBAAiB,QAAS,SAASC,GAC1CmB,GAAWnB,EAAI9G,MACd,GAGHmI,EACGxF,GAAG,eAAgB,KAClB,IAAI6I,EAAMrD,EAAUsD,WAChBxL,EAAOsL,IAAMC,EAAK,OACjBvL,GAASA,EAAK9G,QAEnB8L,EADY,CAACC,QAAS,OAAQjF,KAAMA,MAGrCyL,gBAgCHjJ,cAAYE,GAAG,iBAAkB,SAAUC,EAAOhJ,GAChDlD,EAAI","file":"app.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 31);\n","module.exports = require(\"electron\");","module.exports = require(\"lodash\");","//\n\nexport const tibsyms = {\n  tsek: '་'\n  // connective: 'འི',\n  // subordinative: 'ར', // ladon\n  // narrative: 'འོ',\n  // interrog: 'འམ',\n  // coupling: 'འི',\n  // ergative: 'ས',\n  // concessive: 'འང'\n}\n\nexport const tibsuff = ['འི', 'ར', 'འོ', 'འམ', 'འི', 'ས', 'འང']\n","module.exports = require(\"path\");","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _ = require('lodash');\n\nvar log = console.log;\n\nvar debug = require('debug')('app');\n\nvar d = debug; // https://iso639-3.sil.org/code_tables/639/data --> three letter codes\n// punctuation \\u002E\\u002C\\u0021\\u003A\\u003B\\u00B7 - \\u0020\\u0027 - ... middle dot, - space, apostrophe\n// parens ()[]{-/\n// \\u0028\\u0029\\u005B\\u005D\\u007B\\u007D\\u002D\\u002F\n// greek 0370-03FF 1F00–1FFF\n// diactitic 0300-036F\n// tibetan shad - ། U+0F0D : TIBETAN MARK SHAD {shey} // punctuation\n// common punctuation in this version of sband\n\nvar puncts = \"([.,!:;\\xB7\\u0F0D])\"; // san - sansktit\n\nvar coderanges = {\n  'zho': \"([\\u4E00-\\u9FFF]+)\",\n  'tib': \"([\\u0F00-\\u0FFF]+)\",\n  'grc': \"([\\u0370-\\u03FF\\u1F00-\\u1FFF\\u0300-\\u036F' ]+)\" // note: grc includes space - \\u0020\n\n};\n\nvar _default = function _default(str, code) {\n  var re = new RegExp(coderanges[code]);\n  if (!re.test(str)) return;\n  var clean = str.trim().replace(/᾽/g, \"\\'\");\n  var wopunct = clean.split(\"'\").join('');\n  if (!re.test(wopunct)) return;\n  var rep = new RegExp(puncts);\n  var rows = clean.replace(/\\r?\\n+/, '\\n').split('\\n');\n  var rclauses = rows.map(function (row) {\n    return row.split(rep);\n  });\n  var spans = [];\n  rows.forEach(function (row) {\n    var spns = [];\n    var rclauses = row.split(rep);\n    rclauses.forEach(function (rclause) {\n      if (rep.test(rclause)) {\n        var spn = {\n          text: rclause,\n          punct: true\n        };\n        spns.push(spn);\n      } else {\n        var clauses = rclause.split(re);\n        clauses = _.compact(clauses);\n        clauses.forEach(function (clause) {\n          clause = clause.trim();\n          if (!clause) return;\n          var lang = re.test(clause) ? true : false;\n          var span = {\n            text: clause\n          };\n          if (lang) span.lang = code; // span[code] = true\n          // if (lang) { }\n\n          spns.push(span);\n        });\n      }\n    });\n    spans.push(spns);\n  });\n  return spans;\n};\n\nexports.default = _default;","module.exports = require(\"debug\");","module.exports = require(\"electron-settings\");","module.exports = require(\"electron-is-dev\");","module.exports = require(\"pouchdb\");","//\nimport _ from 'lodash'\nimport {tsek, shad, letter, lower, ralasa, yaralaa, vowel, wasur, kanatanapamaaralasa, kanapamara, tanalasa, tasa, umlaut, sa, sama, maa, la, a, voiced, nasalHigh, up2rows} from './lib/data'\nlet log = console.log\nlet debug = require('debug')('app')\n\nexport default function cholok(str, cumul) {\n  let result  = []\n  let segs = segments(str)\n  segs.forEach((seg, idx)=> {\n    if (seg.tib) {\n      let res = syllable(seg)\n      let trl = translit(res, cumul)\n      result.push(trl)\n    } else {\n      result.push(seg.space)\n    }\n  })\n  return result.join('')\n}\n\nfunction syllable(seg) {\n  let point\n  let syms = seg.tib\n  let main, mains = []\n  let prefix, superfix, prefs = []\n  let suffix, secsuf, avow\n  let sufs = []\n  let quest\n\n  let ult = _.last(syms)\n  let penult = syms[syms.length-2]\n  // if (syms.length > 3 && isVowel(ult)) {\n  if (isVowel(ult)) {\n    if (a == penult) {\n      avow = ult\n      syms.pop()\n    }\n  } else if (penult == a && ult == maa[0]) {\n    syms.pop()\n    syms.pop()\n    quest = {trl: 'am'}\n  }\n\n  let vows = _.intersection(syms, _.keys(vowel))\n  let vow, indexVow\n  if (vows.length == 1) vow = vows[0], indexVow = syms.indexOf(vow)\n  else if (vows.length > 1) return {errs: ['TOO MANY VOWELS']}\n\n  let isWasur = syms.includes(wasur)\n\n  let lowers = _.intersection(syms, _.keys(lower))\n  let subfixes = _.intersection(syms, yaralaa)\n  let subfix, indexSubfix\n  if (subfixes.length == 1) subfix = subfixes[0], indexSubfix = syms.indexOf(subfix)\n\n  if (isWasur) { // རྭ་ // རྩྭ་\n    let indWasur = syms.indexOf(wasur)\n    point = 'wasur'\n    main = syms[indWasur - 1]\n    prefix = syms[indWasur - 2]\n    sufs = syms.slice(indWasur+1)\n  } else if (lowers.length) {\n    point = 1\n    let firstLow = lowers[0]\n    let indexFirstLow = syms.indexOf(firstLow)\n    prefs = syms.slice(0, indexFirstLow)\n    if (vow && subfix) { // ex: རྡྱོག་ ; འརྡྱོག་\n      point = 'vow&&sub'\n      subfix = syms[indexVow - 1]\n      main = syms[indexVow - 2]\n      prefs = syms.slice(0, indexVow - 2)\n      sufs = syms.slice(indexVow+1)\n    } else if (vow) { // superfix: // ex: རྡོག་\n      point = 3\n      main = syms[indexVow - 1]\n      prefs = syms.slice(0, indexVow - 1)\n      sufs = syms.slice(indexVow+1)\n    } else if (subfix) { // ex:     // ex: ཤསྟྲ་\n      point = 'sub'\n      main = syms[indexSubfix - 1]\n      prefs = syms.slice(0, indexSubfix - 1)\n      sufs = syms.slice(indexSubfix+1)\n    } else { // superfixes:  // རྐ་ // རྡག་ // འརྡག་ // རྣ་ // ལྒ་ // ཤྰསྟྲ\n      point = 4\n      let lowLast = lowers.slice(-1)[0]\n      let indexLowLast = syms.indexOf(lowLast)\n      main = syms[indexLowLast]\n      prefs = syms.slice(0, indexLowLast)\n      sufs = syms.slice(indexLowLast+1)\n    }\n  } else if (subfix) { // no lowers // ex: ཁྱི་ ka-yatak-kiku // but not གིྱ ka-kiku-yatak // ཁྱིས་ //  འཁྱིས་  // ex: ཁྱ་ // སྲ་ // མྲ་\n    point = 8\n    main = syms[indexSubfix - 1]\n    prefs = syms.slice(0, indexSubfix - 1)\n    if (vow) {\n      sufs = syms.slice(indexVow+1)\n    } else {\n      sufs = syms.slice(indexSubfix+1)\n    }\n    if (main == a) { // བྱའུ་\n    }\n  } else { // no lowers, no subfixed, no superfix\n    if (vow) { // ex: དོགས་\n      point = 5\n      main = syms[indexVow-1]\n      prefs = syms.slice(0, indexVow-1) // up to vow\n      sufs = syms.slice(indexVow+1)\n      if (main == a) { // དགའོ་\n      }\n    } else { // ex: དགས་\n      point = 6\n      if (syms.length > 4) throw new Error('TOO MANY SYMS IN PLAIN WF')\n      if (syms.length == 1) main = syms[0] // ex: ད་\n      else if (syms.length == 2) { //  དས་ // རག་ // གད་// མས་\n        point = 7\n        main = syms[0]\n        suffix = syms[1]\n      } else if (syms.length == 3 || syms.length == 4) { // prefixes: // ex: འདགས་\n        point = 9\n        prefix = syms[0]\n        main = syms[1]\n        sufs = syms.slice(2)\n      }\n    }\n  }\n\n  if (prefs && prefs.length) {\n    if (prefs.length == 2) {\n      prefix = prefs[0]\n      if (ralasa.includes(prefs[1])) superfix = prefs[1]\n    }\n\n    else if (prefs && prefs.length == 1) {\n      if (ralasa.includes(prefs[0])) superfix = prefs[0]\n      else prefix = prefs[0]\n    }\n  }\n\n  if (sufs && sufs.length) {\n    if (sufs.length == 2) suffix = sufs[0], secsuf = sufs[1]\n    else if (sufs.length == 1) suffix = sufs[0]\n  }\n\n  let data = {point: point, prefix: prefix, superfix: superfix, main: main, subfix: subfix, vow: vow, suffix: suffix, secsuf: secsuf, errs: [], syms: syms} // , isWasur: isWasur\n  if (isWasur) data.wasur = true\n  if (avow) data.avow = avow\n  if (quest) data.quest = quest\n\n  for (let key in data) {\n    if (!data[key]) delete data[key]\n  }\n  if (prefs && prefs.length > 2) {\n    data.errs.push('TOO MANY PREFS')\n    // throw new Error('TOO MANY PREFS')\n  }\n  if (subfixes.length > 1) {\n    data.errs.push('TOO MANY SUBFIXES')\n  }\n\n  if (sufs.length > 2) {\n    data.errs.push('TOO MANY SUFFIXES')\n  }\n  if (!main) {\n    data.errs.push('NO MAIN!')\n  }\n\n  return data\n}\n\nfunction translit(data, cumul) {\n  debug('DATA:', data)\n  if (data.errs.length) {\n    return 'unreal sequence'\n  }\n  let res = {}\n  let stack = []\n  let main\n  if (data.prefix) {\n    let pref = letter[data.prefix]\n\n    main = getLetter(data.main)\n    if (main.col == 3) main.trl = voiced[main.row]\n    else if (main.col == 4 && main.row < 5) main.trl = nasalHigh[main.row]\n    let apref = [pref.trl, 'ao'].join('')\n    if (maa.includes(data.prefix)) {\n      main.trl = ['`', main.trl].join('') // 'n'  '  ’  °'  ???\n    }\n    if (a == data.prefix) {\n      apref = [pref.trl, 'o'].join('')\n    } else {\n      apref = [pref.trl, 'ao'].join('')\n    }\n    if (data.prefix == 'ད' && data.main == 'བ') main.trl = 'w' // excl: p->w\n    stack.push(apref)\n  }\n\n  if (data.superfix) {\n    let superfix = letter[data.superfix]\n    let asuperfix = [superfix.trl, 'a'].join('')\n    stack.push(asuperfix)\n    main = getLower(data.main)\n    if (main.col == 3) main.trl = voiced[main.row]\n    else if (main.col == 4) main.trl = nasalHigh[main.row]\n    let amain = [main.trl, 'a'].join('')\n    let maintak = [amain, 'tak'].join('')\n    stack.push(maintak)\n    if (superfix.trl == 'l' && main.trl == 'h') main.trl = 'hl' // excl: l-h -> h-l\n  } else {\n    if (!main) main = getLetter(data.main)\n  }\n\n  res.main = main\n  let amain = [main.trl, 'a'].join('')\n  stack.push(amain)\n\n  if (data.wasur) stack.push('wasur')\n\n  if (data.subfix) {\n    let subfix = lower[data.subfix]\n    let asub = [subfix.trl, 'a'].join('')\n    let asubtak = [asub, 'tak'].join('')\n    stack.push(asubtak)\n    if (data.subfix == 'ྱ') { // YA\n      if (main.row == 4) {\n        res.main.trl = up2rows[main.col]\n        if (data.prefix == 'ད' && data.main == 'བ') { // excl: p->w->ya\n          main.trl = 'y'\n        }\n      } else {\n        res.main.trl = [res.main.trl, subfix.trl].join('')\n      }\n    } else if (data.subfix ==   'ླ') { // LA\n      if (data.main == 'ཟ') res.main.trl = 'nd'\n      else res.main.trl = 'l'\n    } if (data.subfix == 'ྲ') { // RA\n      if (sama.includes(data.main)) {\n        //\n      } else if ([1,3].includes(main.row)) {\n        res.main.trl = 'ṫ'\n      }\n    }\n    stack.push(pretty(res))\n  }\n  // debug('________BEFORE', stack)\n  if (data.vow) {\n    let vow = _.clone(vowel[data.vow])\n    stack.push(vow.descr)\n    if (data.prefix == 'ད' && data.main == 'བ' && !data.subfix) main.trl = '' // excl: p->w->u\n    let mainvow = [main.trl, vow.trl].join('')\n    res.vow = vow\n    stack.push(mainvow)\n  } else {\n    res.vow = {trl: 'a'}\n  }\n  if (data.suffix) {\n    let suffix = getLetter(data.suffix) //_.clone(letter[data.suffix])\n    res.suffix = suffix\n\n    if (data.avow) {\n      let avow = vowel[data.avow]\n      debug('Avow', avow, 'Stack', stack, 'Res', res)\n      if (data.suffix == a) {\n        res.vow = null\n        stack.push(res.suffix.trl)\n        stack.push(avow.descr)\n        stack.push(avow.trl)\n        if (avow.trl == 'i') {\n          res.suffix.trl = 'ä:'\n        } else {\n          res.suffix.trl = avow.trl\n        }\n      }\n      debug('Stack2', stack)\n      debug('PRETTY', pretty(res))\n    } else {\n      let asuf = [suffix.trl, 'a'].join('')\n      if (kanapamara.includes(data.suffix)) {\n        //\n      } else if (tanalasa.includes(data.suffix)) {\n        res.vow.trl = umlaut[res.vow.trl] || res.vow.trl\n      } else if (a == data.suffix) {\n        asuf = suffix.trl\n      } else {\n        return 'IMPOSSIBLE SUFFIX'\n      }\n      stack.push(asuf)\n    }\n\n    if (tasa.includes(data.suffix)) res.suffix = null\n    if (data.secsuf) {\n      let secsuf = letter[data.secsuf]\n      let asecsuf = [secsuf.trl, 'a'].join('')\n      stack.push(asecsuf)\n    }\n    stack.push(pretty(res))\n  }\n\n  let trl = (cumul) ? stack.join('-') : pretty(res)\n  if (data.quest) trl = [trl, data.quest.trl].join('')\n  trl = trl.replace('aa', 'a').replace('aä', 'ä') //.replace(/\\.$/, '')\n  return trl\n}\n\nfunction pretty(res) {\n  if (!res.vow) res.vow = {trl: 'a'}\n  let str = res.main.trl\n  str = [str, res.vow.trl].join('')\n  if (res.suffix) str = [str, res.suffix.trl].join('')\n  return str\n}\n\nfunction getLetter(str) {\n  let tmp = letter[str]\n  let res\n  if (tmp) res = _.clone(tmp)\n  else res = {trl: str}\n  return res\n}\n\nfunction getLower(str) {\n  let tmp =lower[str]\n  let res\n  if (tmp) res = _.clone(tmp)\n  else res = {trl: str}\n  return res\n}\n\nfunction segments (str) {\n  let syms = str.split('')\n  let segs = []\n  let seg = []\n  syms.forEach(sym=> {\n    if (letter[sym] || lower[sym] || vowel[sym]) {\n      seg.push(sym)\n    } else {\n      if (seg.length) segs.push({tib: seg})\n      seg = []\n      let space\n      if (sym == tsek) space =  {space: '.'}\n      else if (sym == shad) space =  {space: '|'}\n      else space = {space: sym}\n      segs.push(space)\n    }\n  })\n  if (seg.length) segs.push({tib: seg})\n  return segs\n}\n\nfunction isVowel(sym) {\n  return _.keys(vowel).includes(sym)\n}\n","module.exports = require(\"electron-clipboard-extended\");","module.exports = require(\"slash\");","module.exports = require(\"split.js\");","module.exports = require(\"util\");","//\n\nexport const tsek = '་'\nexport const shad = '།'\nexport const ralasa = ['ར', 'ལ', 'ས']\n// export const yaralaa = ['ཡ', 'ར', 'ལ', 'འ']\nexport const kanatanapamaaralasa = ['ག', 'ང', 'ད', 'ན', 'བ', 'མ', 'འ', 'ར', 'ལ', 'ས' ]\nexport const kanapamara = ['ག', 'ང', 'བ', 'མ', 'ར' ]\nexport const tanalasa = ['ད', 'ན', 'ལ', 'ས' ]\nexport const tasa = ['ད', 'ས' ]\nexport const sa = ['ས' ] // secfuffixes\nexport const maa = ['མ', 'འ']\nexport const a = 'འ'\nexport const sama = ['ས' , 'མ']\nexport const la = ['ལ']\nexport const yaralaa = ['ྱ', 'ྲ', 'ླ', 'ྰ'] // subjoined\nexport const wasur = 'ྭ'\nexport const umlaut = {a: 'ä', u: 'ü', o: 'ö'} // ä\nexport const voiced = {1: 'g', 2: 'j', 3: 'd', 4: 'b', 5: 'dz'}\nexport const nasalHigh = {1: 'ŋ', 2: 'ñ', 3: 'n', 4: 'm'}\nexport const up2rows = {1: 'c', 2: 'cʰ', 3: 'c̣ʰ', 4: 'ṇ̃'}\n\nexport const letter = {}\nexport const lower = {}\nexport const vowel = {}\nlower['ྐ'] = {trl: 'k', row: 1, col: 1}  //    \tྐ\nlower['ྑ'] = {trl: 'kʰ', row: 1, col: 2} //     \tྑ\nlower['ྒ'] = {trl: 'ḳʰ', row: 1, col: 3} //   \tྒ\nlower['ྔ'] = {trl: 'ŋ', row: 1, col: 4}  //     ྔ\nlower['ྕ'] = {trl: 'c', row: 2, col: 1}  //    ྕ\nlower['ྖ'] = {trl: 'cʰ', row: 2, col: 2}  //     ྖ\nlower['ྗ'] = {trl: 'c̣ʰ', row: 2, col: 3} //       ྗ\nlower['ྙ'] = {trl: 'ṇ̃', row: 2, col: 4} //    ྙ\nlower['ྟ'] = {trl: 't', row: 3, col: 1}  //    ྟ\nlower['ྠ'] = {trl: 'tʰ', row: 3, col: 2} //    ྠ\nlower['ྡ'] = {trl: 'ṭʰ', row: 3, col: 3} //    ྡ\nlower['ྣ'] = {trl: 'n', row: 3, col: 4}  //    ྣ\nlower['ྤ'] = {trl: 'p', row: 4, col: 1} //    ྤ\nlower['ྥ'] = {trl: 'pʰ', row: 4, col: 2} //    ྥ\nlower['ྦ'] = {trl: 'p̣ʰ', row: 4, col: 3} //    ྦ\nlower['ྨ'] = {trl: 'ṃ', row: 4, col: 4} //    ྨ\nlower['ྩ'] = {trl: 'ç', row: 5, col: 1} //    ྩ\nlower['ྪ'] = {trl: 'çʰ', row: 5, col: 2} //     ྪ\nlower['ྫ'] = {trl: 'ç̣ʰ', row: 5, col: 3} //     ྫ\n\nlower['ྱ'] = {trl: 'y', row: 6, col: 4} //     ྱ\nlower['ྲ'] = {trl: 'r', row: 7, col: 1} //    ྲ\nlower['ླ'] = {trl: 'l', row: 7, col: 2} //    ླ\nlower['ྷ'] = {trl: 'h', row: 8, col: 1} //    ྷ\nlower[''] = {trl: '', row: 1, col: 1}\nlower[''] = {trl: '', row: 1, col: 1}\n\n//   ྱ   d  fྱ\n\nletter['ཀ'] = {trl: 'k', row: 1, col: 1}\nletter['ཁ'] = {trl: 'kʰ', row: 1, col: 2}\nletter['ག'] = {trl: 'ḳʰ', row: 1, col: 3}\nletter['ང'] = {trl: 'ŋ', row: 1, col: 4} // lower dot?\nletter['ཅ'] = {trl: 'c', row: 2, col: 1}\nletter['ཆ'] = {trl: 'cʰ', row: 2, col: 2}\nletter['ཇ'] = {trl: 'c̣ʰ', row: 2, col: 3}\nletter['ཉ'] = {trl: 'ñ', row: 2, col: 4} // lower dot?\nletter['ཏ'] = {trl: 't', row: 3, col: 1}\nletter['ཐ'] = {trl: 'tʰ', row: 3, col: 2}\nletter['ད'] = {trl: 'ṭʰ', row: 3, col: 3}\nletter['ན'] = {trl: 'n', row: 3, col: 4} // lower dot?\nletter['པ'] = {trl: 'p', row: 4, col: 1}\nletter['ཕ'] = {trl: 'pʰ', row: 4, col: 2}\nletter['བ'] = {trl: 'p̣ʰ', row: 4, col: 3}\nletter['མ'] = {trl: 'm', row: 4, col: 4} // lower dot?\n\nletter['ཙ'] = {trl: 'ç', row: 5, col: 1}\nletter['ཚ'] = {trl: 'çʰ', row: 5, col: 2}\nletter['ཛ'] = {trl: 'ç̣ʰ', row: 5, col: 3}\nletter['ཝ'] = {trl: 'w', row: 5, col: 4}\n\nletter['ཞ'] = {trl: 'ṣ̂', row: 6, col: 1}\nletter['ཟ'] = {trl: 'ṣ', row: 6, col: 2}\nletter['འ'] = {trl: 'a', row: 6, col: 3} // lower dot?\nletter['ཡ'] = {trl: 'y', row: 6, col: 4} // lower dot?\n\nletter['ར'] = {trl: 'r', row: 7, col: 1} // lower dot?\nletter['ལ'] = {trl: 'l', row: 7, col: 2} // lower dot?\nletter['ཤ'] = {trl: 'ŝ', row: 7, col: 3}\nletter['ས'] = {trl: 's', row: 7, col: 4}\nletter['ཧ'] = {trl: 'h', row: 8, col: 1}\nletter['ཨ'] = {trl: 'a', row: 8, col: 2}\n// letter[''] = {trl: '', row: 6, col: 1}\n\n/*\n ཀ \tka \tཁ \tkʰa \tག \tḳʰa\tང \tŋa\n  ཅ \tca \tཆ \tcʰa \tཇ \tc̣ʰa \tཉ \tṇ̃a\n  ཏ \tta \tཐ \ttʰa \tད \tṭʰa \t ན \tna\n  པ \tpa \tཕ \tpʰa \tབ \tp̣ʰa \tམ \tṃa\n  ཙ \tça \tཚ \tçʰa \tཛ \tç̣ʰa \tཝ \tẉa\n  ཞ \tṣ̂a \tཟ \tṣa \tའ \ta  \tཡ \tya\n  ར \tra \tལ \tla \tཤ \tŝa \tས \tsa\n  ཧ \tha \tཨ \ta\n\n*/\n\n\nvowel['ཱ'] = {trl: 'a', descr: 'a-chung'} //    \t ཱ - subscript a, vowel-lengthening mark\nvowel['ི'] = {trl: 'i', descr: 'kiku'}\nvowel['ུ'] = {trl: 'u', descr: 'ŝapkyu'}\nvowel['ོ'] = {trl: 'o', descr: 'naro'}\nvowel['ེ'] = {trl: 'e', descr: 'ḋeŋbu'}\n","module.exports = require(\"pouchdb-authentication\");","module.exports = require(\"mousetrap\");","module.exports = require(\"json5\");","module.exports = require(\"axios\");","import _ from 'lodash'\n\nlet util = require('util')\n\nexport function q (sel) {\n  return document.querySelector(sel)\n}\n\nexport function qs (sel) {\n  return document.querySelectorAll(sel)\n}\n\nexport function create (tag, style) {\n  let el = document.createElement(tag)\n  if (style) el.classList.add(style)\n  return el\n}\n\nexport function recreateDiv (sel) {\n  let el = document.querySelector(sel)\n  if (el) el.parentElement.removeChild(el)\n  el = document.createElement('div')\n  el.classList.add(sel)\n  // el.id = sel\n  return el\n}\n\nexport function recreate (element) {\n  var newElement = element.cloneNode(true)\n  element.parentNode.replaceChild(newElement, element)\n}\n\n// function cret (str) {\n//   return document.createTextNode(str)\n// }\n\nexport function span (str, style) {\n  let el = document.createElement('span')\n  el.textContent = str\n  if (style) el.classList.add(style)\n  return el\n}\n\nexport function br () {\n  let oBR = document.createElement('br')\n  return oBR\n}\n\nexport function div (str, style) {\n  let el = document.createElement('div')\n  el.textContent = str\n  if (style) el.classList.add(style)\n  return el\n}\n\nexport function p (str, style) {\n  let el = document.createElement('p')\n  el.textContent = str\n  if (style) el.classList.add(style)\n  return el\n}\n\nexport function empty (el) {\n  if (!el) return\n  while (el.hasChildNodes()) {\n    el.removeChild(el.lastChild)\n  }\n}\n\nexport function remove (el) {\n  if (!el) return\n  el.parentElement.removeChild(el)\n}\n\nexport function removeAll (sel) {\n  let els = document.querySelectorAll(sel)\n  els.forEach(el => { el.parentElement.removeChild(el) })\n}\n\n// function closeAll() {\n//     words = null\n//     // window.close()\n//     ipcRenderer.send('sync', 'window-hide')\n// }\n\nexport function findAncestor (el, cls) {\n  while ((el = el.parentElement) && el.classList.contains(cls)) {\n    return el\n  }\n}\n\nexport function plog () {\n  var vs = _.values(arguments)\n  if (vs.length === 1) vs = vs[0]\n  // console.log(util.inspect(vs, {showHidden: false, depth: null}))\n  console.log(util.inspect(vs, {showHidden: false, depth: 3}))\n}\n\nexport function getCoords (el) {\n  let rect = el.getBoundingClientRect()\n  return rect\n  // return {top: rect.top, left: rect.left}\n}\n\nexport function placePopup (coords, el) {\n  let top = [coords.top, 'px'].join('')\n  let left = [coords.left, 'px'].join('')\n  el.style.top = top\n  el.style.left = left\n}\n\n// https://stackoverflow.com/questions/24538450/get-element-currently-under-mouse-without-using-mouse-events\nexport function getInnermostHovered() { return [].slice.call(document.querySelectorAll(':hover')).pop(); }\n","//\nimport _ from 'lodash'\nimport { q, qs, empty, create, remove, span, p, div, getCoords, placePopup, getInnermostHovered } from './utils'\nimport cholok from '../../../cholok'\nimport { tibsyms, tibsyls } from \"./tibetan_data\";\nimport { ipcRenderer } from \"electron\";\nconst settings = require('electron').remote.require('electron-settings')\n\nlet tsek = tibsyms.tsek\nconst log = console.log\n\nexport function showText(state) {\n  let pars = state.pars\n  let osource = q('#source')\n  let oresult = q('#result')\n  empty(osource)\n  empty(oresult)\n\n  pars.forEach(spans => {\n    let opar = p()\n    opar.classList.add('tibpar')\n    spans.forEach(spn => {\n      let ospan = span(spn.text)\n      if (spn.lang) ospan.classList.add('tibphrase') // , wfs.push(spn.text)\n      else if (spn.punct) ospan.classList.add('punct') //, wfs.push(spn.text)\n      else ospan.classList.add('space')\n      opar.appendChild(ospan)\n    })\n    osource.appendChild(opar)\n  })\n\n  let grs = qs('span.tibetan')\n  // if (grs.length == 1) showResults(grs[0].textContent)\n}\n\nexport function showCholok(el, cumulative) {\n  let coords = getCoords(el)\n  let trnanscript = (cumulative) ? cholok(el.textContent, true) : cholok(el.textContent)\n  let ncoords = {top: coords.top - 40, left: coords.left + 15}\n  let otrans = q('#transcript')\n  otrans.textContent = trnanscript\n  otrans.classList.remove('is-hidden')\n  placePopup(ncoords, otrans)\n}\n\nexport function parsePhrase(el, chain, lastsek) {\n  if (!el) return\n  el.textContent = ''\n  chain.forEach((seg, idx)=> {\n    let ospan\n    if (seg.ambi) {\n      ospan = span(seg.seg, 'tibambi')\n      ospan.dataset.chains = JSON.stringify(seg.chains)\n    } else if (seg.docs.length) {\n      ospan = span(seg.seg, 'tibwf')\n      ospan.dataset.docs = JSON.stringify(seg.docs)\n    } else {\n      ospan = span(seg.seg, 'tibphrase')\n    }\n    el.appendChild(ospan)\n    if (idx < chain.length-1) el.appendChild(span(tsek, 'tsek'))\n  })\n  if (lastsek) el.appendChild(span(tsek, 'tsek'))\n}\n\nfunction createPopup(el, upper) {\n  let oambi\n  if (upper) {\n    oambi = create('div', 'popup')\n    oambi.classList.add('upper')\n    document.body.appendChild(oambi)\n  } else oambi = q('#ambi')\n\n  let coords = getCoords(el)\n  empty(oambi)\n  oambi.classList.remove('is-hidden')\n  let ncoords = {top: coords.bottom-3, left: coords.left}\n  placePopup(ncoords, oambi)\n  let oul = create('ul', 'ambilist')\n  oambi.appendChild(oul)\n  return oul\n}\n\nexport function showPopup(el, compound) {\n  let chains\n  try {\n    chains = JSON.parse(el.dataset.chains)\n  } catch(err) {\n    log('ERR: JSON chains', el) // ================== ошибка есть\n    return\n  }\n  let upper = (el.closest('.tibpar')) ? false : true\n  let oul = createPopup(el, upper)\n  // if (el.classList.contains('tibambi')) showAmbi(oul, chains)\n  // else if (el.classList.contains('tibwf')) showCompound(oul, chains)\n  if (compound) showCompound(oul, chains)\n  else showAmbi(oul, chains)\n}\n\nfunction showAmbi(oul, chains) {\n  oul.classList.add('danger')\n  chains.forEach(chain=> {\n    let oline = create('li', 'ambiline')\n    oul.appendChild(oline)\n    chain.forEach(seg=> {\n      let owf = (seg.docs.length) ? span(seg.seg, 'tibwf') : span(seg.seg, 'tibphrase')\n      if (seg.docs.length) owf.dataset.docs = JSON.stringify(seg.docs)\n      oline.appendChild(owf)\n    })\n  })\n}\n\nfunction showCompound(oul, chains) {\n  // log('COMPOUND', chains)\n  chains.forEach(seg=> {\n    let oline = create('li', 'ambiline')\n    oul.appendChild(oline)\n    let ospan\n    if (seg.ambi) {\n      ospan = span(seg.seg, 'tibambi')\n      ospan.dataset.chains = JSON.stringify(seg.chains)\n    } else if (seg.docs.length) {\n      ospan = span(seg.seg, 'tibwf')\n      ospan.dataset.docs = JSON.stringify(seg.docs)\n    } else {\n      ospan = span(seg.seg, 'tibphrase')\n    }\n    oline.appendChild(ospan)\n  })\n}\n\nexport function showResults(el) {\n  let osource = q('#source')\n  let oresult = q('#result')\n  empty(oresult)\n  let wf = el.textContent\n\n  let docs = JSON.parse(el.dataset.docs)\n  try {\n    docs = JSON.parse(el.dataset.docs)\n  } catch(err) {\n    log('ERR: JSON docs', err)\n    return\n  }\n\n  let cfg = settings.get('cfg')\n  // let str = JSON.parse(JSON.stringify(cfg))\n  // log('SHOW RESULTS: cfg', str)\n\n  docs.forEach(doc=> { doc.weight = _.find(cfg, dict=> { return doc.dname == dict.dname }).idx })\n  docs = _.sortBy(docs, 'weight')\n  // log('RESULT docs', wf, docs)\n\n  let odict = create('div', 'dict')\n  oresult.appendChild(odict)\n  let owf = create('p', 'dict-wf')\n  owf.textContent = wf\n  odict.appendChild(owf)\n  docs.forEach(doc=> {\n    let odname = create('p', 'dict-dname')\n    odname.textContent = doc.dname\n    odict.appendChild(odname)\n    let oarticle = create('p', 'dict-article')\n    oarticle.textContent = doc.dict\n    odict.appendChild(oarticle)\n    let oul = create('ul', 'dict-ul')\n    odict.appendChild(oul)\n    if (!doc.trns) log('NO TRNS', doc)\n    if (!doc.trns) return\n    doc.trns.forEach(trn=> {\n      let oline = create('li', 'dict-line')\n      oline.textContent = trn\n      oul.appendChild(oline)\n    })\n  })\n}\n\n\nexport function noResult(el) {\n  // log('NO RESULT')\n  // let oresult = q('#result')\n  // empty(oresult)\n}\n\nlet xxx = function(n,o,u) {\n  if (n._id && !n._id.indexOf(\"_local/\")) return;\n  if (!u || !u.roles || u.roles.indexOf(\"_admin\") == -1) { throw({forbidden:'Denied.' })}\n}\n\n\n// ======================= DBS ==============================\n\nexport function queryDBs(el, compound) {\n  let progress = q('#progress')\n  progress.classList.remove('is-hidden')\n  let text = el.textContent.trim()\n  let retsek = new RegExp(tsek+'$')\n  let str = text.replace(retsek, '')\n  let last = _.last(text)\n  let lastsek = (last == tsek) ? true : false\n  let query = {str: str, compound: compound, lastsek: lastsek}\n  ipcRenderer.send('queryDBs', query)\n}\n\nipcRenderer.on('replayDBs', function (event, query) {\n  let progress = q('#progress')\n  progress.classList.add('is-hidden')\n  let chain = query.chain\n  let el = getInnermostHovered()\n  if (!chain) {\n    noResult(el)\n    return\n  }\n  if (query.compound) {\n    el.dataset.chains = JSON.stringify(chain)\n    showPopup(el, true)\n  }\n  else parsePhrase(el, chain, query.lastsek)\n})\n","//\nimport _ from 'lodash'\nimport { ipcRenderer } from \"electron\";\nimport { q, qs, empty, create, remove, span, p, div, getCoords, placePopup } from './utils'\nimport { navigate } from './nav'\n// import { setCfg } from \"../dbs/pouch\";\n\nconst log = console.log\nconst settings = require('electron-settings')\n\nipcRenderer.on('remoteDictsReply', function (event, rdbs) {\n  // let cloneErr = q('#cloneERR')\n  // let progress = q('#progress')\n  // progress.classList.add('is-hidden')\n  // if (rdbs) showRemoteDicts(rdbs)\n  // else cloneErr.classList.remove('is-hidden')\n  hideProgress(rdbs)\n  showRemoteDicts(rdbs)\n})\n\nipcRenderer.on('replicateReply', function (event, res) {\n  hideProgress(res)\n  let state = {section: 'activedicts'}\n  navigate(state)\n})\n\nipcRenderer.on('csvReply', function (event, res) {\n  hideProgress(res)\n  let state = {section: 'activedicts'}\n  navigate(state)\n})\n\nipcRenderer.on('cleanupReply', function (event, res) {\n  hideProgress(res)\n  let state = {section: 'clonedicts'}\n  navigate(state)\n})\n\nfunction hideProgress(res) {\n  let cloneErr = q('#cloneERR')\n  let progress = q('#progress')\n  if (res) progress.classList.add('is-hidden')\n  else cloneErr.classList.remove('is-hidden')\n}\n\n\nfunction showRemoteDicts(rdbs) {\n  // let upath = settings.get('upath')\n  let cfg = settings.get('cfg')\n  // log('CLONE DICTS: CFG:', cfg)\n  let defaults = ['_users']\n  let locals = cfg.map(dict=> { return dict.dname })\n  let installed = _.uniq(defaults.concat(locals))\n\n  let otable = q('#server-dicts-table tbody')\n  empty(otable)\n  rdbs.forEach(rdb=> {\n    if (defaults.includes(rdb.dname)) return\n    let otr = create('tr')\n    otable.appendChild(otr)\n    let odt = create('td')\n    otr.appendChild(odt)\n    odt.textContent = _.capitalize(rdb.dname)\n    let osize = create('td', 'dsize')\n    osize.textContent = _.capitalize(rdb.size)\n    otr.appendChild(osize)\n    let oink = create('td', 'link')\n    if (installed.includes(rdb.dname)) {\n      let check = checkmark()\n      oink.appendChild(check)\n    } else {\n      oink.textContent = 'sync'\n    }\n    oink.dataset.clone = rdb.dname\n    otr.appendChild(oink)\n  })\n}\n\nexport function showActiveDicts() {\n  let cfg = settings.get('cfg')\n  let dnames = cfg.map(cf=> { return cf.name })\n  let mess = q('#adictmessage')\n  if (dnames.length) mess.textContent = 'click dict\\'s name to move it first'\n  let otable = q('#local-dicts-table tbody')\n  empty(otable)\n  cfg.forEach(dict=> {\n    let name = dict.dname\n    let otr = create('tr')\n    otable.appendChild(otr)\n    let odt = create('td', 'dictname')\n    otr.appendChild(odt)\n    odt.textContent = _.capitalize(name)\n    odt.dataset.firstdict = name\n    let oactive = create('td', 'active-dict')\n    if (dict.active) {\n      let check = checkmark()\n      oactive.appendChild(check)\n    } else {\n      oactive.textContent = 'activate'\n    }\n    oactive.dataset.activedict = name\n    otr.appendChild(oactive)\n    let ocsv = create('td', 'dictcsv')\n    ocsv.textContent = 'toCSV'\n    ocsv.dataset.csv = name\n    otr.appendChild(ocsv)\n  })\n}\n\nexport function moveDictFirst(dname) {\n  let cfg = settings.get('cfg')\n  let dict = _.find(cfg, dict=> { return dict.dname == dname })\n  let rest = _.reject(cfg, dict=> { return dict.dname == dname })\n  rest.unshift(dict)\n  cfg = rest\n  cfg.forEach((dict, idx)=> { dict.idx = idx })\n  settings.set('cfg', cfg)\n  // setCfg()\n  showActiveDicts()\n}\n\nexport function activateDict(el) {\n  let cfg = settings.get('cfg')\n  let dict = _.find(cfg, dict=> { return dict.dname == el.dataset.activedict })\n  let check = checkmark()\n  if (el.textContent) {\n    el.textContent = ''\n    el.appendChild(check)\n    dict.active = true\n  } else {\n    empty(el)\n    el.textContent = 'activate'\n    dict.active = false\n  }\n  settings.set('cfg', cfg)\n}\n\nfunction checkmark() {\n  let check = create('img', 'dict-check')\n  check.setAttribute('src', '../resources/check.png')\n  return check\n}\n\nexport function parseCSV() {\n  log('PARSE START CSV')\n}\n","//\n\nconst path = require('path')\n\nconst settings = require('electron-settings')\nconst log = console.log\nconst PouchDB = require('pouchdb')\nPouchDB.plugin(require('pouchdb-authentication'));\n\nexport function signup(upath) {\n  let serverAuth = new PouchDB('http://localhost:5984/mydb', {skip_setup: true})\n  let localpath = path.resolve(upath, 'pouch', 'auth')\n  let localDB = new PouchDB(localpath)\n  localDB.sync(serverAuth, {live: true, retry: true}).on('error', console.log.bind(console))\n\n  serverAuth.signUp('batman', 'brucewayne', function (err, response) {\n    if (err) {\n      if (err.name === 'conflict') {\n        // \"batman\" already exists, choose another username\n      } else if (err.name === 'forbidden') {\n        // invalid username\n      } else {\n        // HTTP error, cosmic rays, etc.\n      }\n    }\n  })\n    .then(function(res) {\n      log('SIGNUP RES', res)\n    })\n  return\n}\n","//\nimport _ from \"lodash\"\nimport { ipcRenderer } from \"electron\";\nimport { q, qs, empty, create, remove, span, p, div, enclitic } from './utils'\nimport Split from 'split.js'\nimport { showText } from \"./parsedata\";\nimport { serverDicts, showActiveDicts, parseCSV } from \"./dict\";\nimport { signup } from \"./auth\";\n\nimport { remote } from \"electron\";\nconst app = remote.app;\nconst apath = app.getAppPath()\nconst upath = app.getPath(\"userData\")\n\nconst log = console.log\nconst clipboard = require('electron-clipboard-extended')\nconst settings = require('electron').remote.require('electron-settings')\nconst Mousetrap = require('mousetrap')\nconst path = require('path')\nconst slash = require('slash')\nconst {getCurrentWindow} = require('electron').remote\n\n// let init = {section: 'home'}\nlet history = []\nlet hstate = 0\nlet split\n\nfunction twoPanes(state) {\n\n  let sizes = settings.get('split-sizes') || [50, 50]\n  if (split && state.mono) split.collapse(1)\n  else if (split) split.setSizes(sizes)\n\n  if (split) return\n  settings.set('split-sizes', sizes)\n\n  split = Split(['#source', '#result'], {\n    sizes: sizes,\n    gutterSize: 5,\n    cursor: 'col-resize',\n    minSize: [0, 0],\n    onDragEnd: function (sizes) {\n      settings.set('split-sizes', sizes)\n      getCurrentWindow().reload()\n    }\n  })\n  if (state.mono) split.collapse(1)\n\n  document.addEventListener(\"keydown\", function(ev) {\n    // keyPanes(ev, state)\n  }, false)\n\n  document.addEventListener(\"wheel\", function(ev) {\n    // scrollPanes(ev, state)\n  }, false)\n}\n\n// arrows\nMousetrap.bind(['alt+left', 'alt+right'], function(ev) {\n  if (ev.which == 37) goLeft()\n  else if (ev.which == 39) goRight()\n})\n\nMousetrap.bind(['alt+1', 'alt+2'], function(ev) {\n  // if (ev.which == 49) log('----1')\n  // else if (ev.which == 50) log('----2')\n})\n\nMousetrap.bind(['esc'], function(ev) {\n  // похоже, общий метод не получится\n})\n\nMousetrap.bind(['ctrl+d'], function(ev) {\n  let datapath = '/home/michael/diglossa.texts/Tibetan'\n  ipcRenderer.send('scanLocalDict', datapath)\n})\n\nMousetrap.bind(['ctrl+j'], function(ev) {\n  let csvpath = '/home/michael/tibetan/utils/csv/csvdict.json'\n  log('IMPORT', csvpath)\n  ipcRenderer.send('importcsv', csvpath)\n})\n\nMousetrap.bind(['ctrl+i'], function(ev) {\n  ipcRenderer.send('infoDB', 'csvdict')\n})\n\nMousetrap.bind(['ctrl+v'], function(ev) {\n  ipcRenderer.send('infoDB', 'vasilyev')\n})\n\n\n\nMousetrap.bind(['ctrl+u'], function(ev) {\n  log('CLICK SIGNUP')\n  signup(upath)\n})\n\nfunction goLeft() {\n  if (hstate <= 0) return\n  else hstate--\n  let state = history[hstate]\n  state.old = true\n  hideAll()\n  navigate(state)\n}\n\nfunction goRight() {\n  if (hstate >= history.length-1) return\n  else hstate++\n  let state = history[hstate]\n  state.old = true\n  hideAll()\n  navigate(state)\n}\n\nexport function navigate(state) {\n  try {\n    state = JSON.parse(JSON.stringify(state))\n  } catch (err) {\n    log('NAV-state ERR', err)\n    state = {}\n  }\n  let section = state.section || 'home'\n  if (!section) state.section = 'home'\n  showSection(state.section)\n\n  if (!state.old) {\n    state.old = false\n    delete state.old\n    history.push(state)\n    hstate = history.length-1\n  }\n  if (section == 'main') twoPanes(state), showText(state)\n  else if (section == 'clonedicts') ipcRenderer.send('remoteDicts', '') // serverDicts()\n  else if (section == 'activedicts') showActiveDicts()\n\n  let progress = q('#progress')\n  progress.classList.add('is-hidden')\n\n  // state = {section: 'home'}\n  settings.set('state', state)\n}\n\nfunction showSection(section) {\n  hideAll()\n  const sectionId = ['#', section].join('')\n  q(sectionId).classList.remove('is-hidden')\n  q(sectionId).classList.add('is-shown')\n}\n\nfunction hideAll () {\n  // const sections = document.querySelectorAll('.section')\n  const sections = qs('.section')\n  Array.prototype.forEach.call(sections, (section) => {\n    section.classList.add('is-hidden')\n    section.classList.remove('is-shown')\n  })\n  let otrans = q('#transcript')\n  otrans.classList.add('is-hidden')\n  let oambi = q('#ambi')\n  oambi.classList.add('is-hidden')\n}\n","// import \"./stylesheets/main.css\";\n\nimport _ from \"lodash\";\n// import Split from 'split.js'\nimport { remote } from \"electron\";\nimport { shell } from 'electron'\nimport { ipcRenderer } from \"electron\";\n\nimport { q, qs, empty, create, remove, span, p, div, getInnermostHovered } from './lib/utils'\nimport { navigate } from './lib/nav'\n// import sband from \"./lib/sband\"; <<<=== убрать из lib\nimport sband from \"../../../sband\"\nimport { showCholok, showResults, showPopup, queryDBs } from \"./lib/parsedata\"\nimport { moveDictFirst, activateDict } from \"./lib/dict\"\n\nconst settings = require('electron').remote.require('electron-settings')\n// const Mousetrap = require('mousetrap')\n\nconst JSON = require('json5')\nconst axios = require('axios')\n// let fse = require('fs-extra')\nconst slash = require('slash')\nconst log = console.log\n\nconst path = require('path')\n\nconst clipboard = require('electron-clipboard-extended')\nconst {dialog, getCurrentWindow} = require('electron').remote\n\nconst isDev = require('electron-is-dev')\n// const isDev = false\n// const isDev = true\n// const app = remote.app;\n\nlet over = q(\"#new-version\")\nlet progress = q('#progress')\n\nlet container = q('#container')\nlet imports = qs('link[rel=\"import\"]')\nimports.forEach(link=> {\n  let content = link.import\n  let section = content.querySelector('.section')\n  container.appendChild(section.cloneNode(true))\n})\n\nipcRenderer.on('version', function (event, oldver) {\n  axios.get('https://api.github.com/repos/mbykov/pecha.js/releases/latest')\n    .then(function (response) {\n      if (!response || !response.data) return\n      let newver = response.data.name\n      if (oldver && newver && newver > oldver) {\n        let over = q(\"#new-version\")\n        let verTxt = ['new version available:', newver].join(' ')\n        over.textContent = verTxt\n        over.classList.remove('is-hidden')\n      }\n    })\n    .catch(function (error) {\n      console.log('API ERR')\n    })\n})\n\nipcRenderer.on('section', function (event, section) {\n  navigate({section: section})\n})\n\n// ctrl-R\nipcRenderer.on('reread', function (event) {\n  let state = settings.get('state')\n  getCurrentWindow().reload()\n  navigate(state)\n})\n\nlet state = settings.get('state')\nif (!state) state = {section: 'home'}\nnavigate(state)\n\ndocument.addEventListener('click', (ev) => {\n  // let progress = q('#progress')\n  let data = ev.target.dataset\n  if (!data) return\n  let parent = ev.target.parentElement\n  if (ev.target.classList.contains('external')) {\n    let href = ev.target.textContent\n    shell.openExternal(href)\n  } else if (data.section) {\n    navigate({section: data.section})\n  } else if (data.clone) {\n    progress.classList.remove('is-hidden')\n    ipcRenderer.send('replicate', data.clone)\n  } else if (data.firstdict) {\n    moveDictFirst(data.firstdict) // ev.target,\n  } else if (data.activedict) {\n    activateDict(ev.target)\n  } else if (data.csv) {\n    progress.classList.remove('is-hidden')\n    ipcRenderer.send('export-to-csv', data.csv)\n  } else if (parent && parent.dataset && parent.dataset.activedict) {\n    // activateDict(parent)\n    // log('activateDict(parent)_______')\n  } else if (ev.target.id == 'cleanupdb') {\n    ipcRenderer.send('cleanupDB')\n  } else if (ev.target.id == 'scandir') {\n    dialog.showOpenDialog( {properties: ['openDirectory'] }, scanDir)\n  } else if (ev.target.id == 'importcsv') {\n    dialog.showOpenDialog({properties: ['openFile'], filters: [{name: 'JSON', extensions: ['json'] }]}, importCSV)\n  } else if (data.docs) {\n    queryDBs(ev.target , true)\n  }\n})\n\ndocument.addEventListener(\"mouseover\", function(ev) {\n  if (!ev.target.textContent) return\n  if (ev.ctrlKey == true) return\n  let tpar = ev.target.closest('.tibpar')\n  if (tpar) hidePopups()\n\n  if (ev.target.classList.contains('tibphrase')) {\n    if (ev.shiftKey == true) {\n      // showCholok(ev.target)\n    } else {\n      queryDBs(ev.target)\n    }\n  } else if (ev.target.classList.contains('tibwf')) {\n    showResults(ev.target)\n  } else if (ev.target.classList.contains('tibambi')) {\n    showPopup(ev.target) // mouseover, tibambi\n  }\n}, false)\n\ndocument.addEventListener(\"mouseleave\", function(ev) {\n  if (!ev.target.classList) return\n  if (ev.ctrlKey == true) return\n  if (ev.target.classList.contains('tibphrase')) {\n    let otrans = q('#transcript')\n    otrans.classList.add('is-hidden')\n  }\n}, false)\n\ndocument.addEventListener(\"keyup\", function(ev) {\n  if (ev.ctrlKey == true) return\n  // hidePopups()\n  let transcript = q('#transcript')\n  transcript.classList.add('is-hidden')\n}, false)\n\ndocument.addEventListener(\"keydown\", function(ev) {\n  // if (ev.ctrlKey == true) return\n  if (ev.shiftKey != true) return\n  let ohover = getInnermostHovered()\n  if (!ohover) return\n  if (ohover.id == 'source') ohover = q('.tibpar')\n  let text = ohover.textContent\n  let pars = sband(text, 'tib')\n  if (!pars) return\n  showCholok(ohover)\n  if (ev.ctrlKey == true) showCholok(ohover, true)\n}, false)\n\ndocument.addEventListener(\"wheel\", function(ev) {\n  scrollPane(ev, state)\n}, false)\n\n\nclipboard\n  .on('text-changed', () => {\n    let txt = clipboard.readText()\n    let pars = sband(txt, 'tib')\n    if (!pars || !pars.length) return\n    let state = {section: 'main', pars: pars}\n    navigate(state)\n  })\n  .startWatching()\n\nfunction hidePopups() {\n  qs('.popup').forEach(popup=> {\n    popup.classList.add('is-hidden')\n  })\n}\n\nexport function scrollPane(ev, state) {\n  if (ev.shiftKey == true) return;\n  let delta = (ev.deltaY > 0) ? 24 : -24\n  let opane = q('.section.is-shown')\n  if (!opane) return\n  opane.scrollTop += delta\n}\n\nfunction scanDir(fns) {\n  if (!fns) return\n  let datapath = fns[0]\n  if (!datapath) return\n  progress.classList.remove('is-hidden')\n  ipcRenderer.send('scanLocalDict', datapath)\n}\n\nfunction importCSV(fns) {\n  if (!fns) return\n  let csvpath = fns[0]\n  if (!csvpath) return\n  progress.classList.remove('is-hidden')\n  ipcRenderer.send('import-from-csv', csvpath)\n}\n\nipcRenderer.on('scanLocalReply', function (event, res) {\n  log('SCANNED!')\n})\n"],"sourceRoot":""}