!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=31)}([function(t,e){t.exports=require("electron")},function(t,e){t.exports=require("lodash")},function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i});const r={tsek:"་"},i=["འི","ར","འོ","འམ","འི","ས","འང"]},function(t,e){t.exports=require("path")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1),i=(console.log,n(5)("app"),{zho:"([一-鿿]+)",tib:"([ༀ-࿿]+)",grc:"([Ͱ-Ͽἀ-῿̀-ͯ' ]+)"});e.default=function(t,e){var n=new RegExp(i[e]);if(n.test(t)){var o=t.trim().replace(/᾽/g,"'"),l=o.split("'").join("");if(n.test(l)){var s=new RegExp("([.,!:;·།])"),a=o.replace(/\r?\n+/,"\n").split("\n"),c=(a.map(function(t){return t.split(s)}),[]);return a.forEach(function(t){var i=[];t.split(s).forEach(function(t){if(s.test(t)){var o={text:t,punct:!0};i.push(o)}else{var l=t.split(n);(l=r.compact(l)).forEach(function(t){if(t=t.trim()){var r={text:t};!!n.test(t)&&(r.lang=e),i.push(r)}})}}),c.push(i)}),c}}}},function(t,e){t.exports=require("debug")},function(t,e){t.exports=require("electron-settings")},,function(t,e){t.exports=require("electron-is-dev")},function(t,e){t.exports=require("pouchdb")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=[];return function(t){var e=t.split(""),n=[],r=[];e.forEach(function(t){if(l.letter[t]||l.lower[t]||l.vowel[t])r.push(t);else{r.length&&n.push({tib:r}),r=[];var e=void 0;e=t==l.tsek?{space:"."}:t==l.shad?{space:"|"}:{space:t},n.push(e)}}),r.length&&n.push({tib:r});return n}(t).forEach(function(t,r){if(t.tib){var i=function(t,e){if(s("DATA:",t),t.errs.length)return"unreal sequence";var n,r,i={},d=[],u=void 0;if(t.prefix){var p=l.letter[t.prefix];3==(u=c(t.main)).col?u.trl=l.voiced[u.row]:4==u.col&&u.row<5&&(u.trl=l.nasalHigh[u.row]);var f=[p.trl,"ao"].join("");l.maa.includes(t.prefix)&&(u.trl=["`",u.trl].join("")),f=l.a==t.prefix?[p.trl,"o"].join(""):[p.trl,"ao"].join(""),"ད"==t.prefix&&"བ"==t.main&&(u.trl="w"),d.push(f)}if(t.superfix){var h=l.letter[t.superfix],v=[h.trl,"a"].join("");d.push(v),3==(n=t.main,r=l.lower[n],u=r?o.default.clone(r):{trl:n}).col?u.trl=l.voiced[u.row]:4==u.col&&(u.trl=l.nasalHigh[u.row]);var g=[u.trl,"a"].join(""),m=[g,"tak"].join("");d.push(m),"l"==h.trl&&"h"==u.trl&&(u.trl="hl")}else u||(u=c(t.main));i.main=u;var w=[u.trl,"a"].join("");if(d.push(w),t.wasur&&d.push("wasur"),t.subfix){var x=l.lower[t.subfix],b=[x.trl,"a"].join(""),y=[b,"tak"].join("");d.push(y),"ྱ"==t.subfix?4==u.row?(i.main.trl=l.up2rows[u.col],"ད"==t.prefix&&"བ"==t.main&&(u.trl="y")):i.main.trl=[i.main.trl,x.trl].join(""):"ླ"==t.subfix&&("ཟ"==t.main?i.main.trl="nd":i.main.trl="l"),"ྲ"==t.subfix&&(l.sama.includes(t.main)||[1,3].includes(u.row)&&(i.main.trl="ṫ")),d.push(a(i))}if(t.vow){var C=o.default.clone(l.vowel[t.vow]);d.push(C.descr),"ད"!=t.prefix||"བ"!=t.main||t.subfix||(u.trl="");var E=[u.trl,C.trl].join("");i.vow=C,d.push(E)}else i.vow={trl:"a"};if(t.suffix){var L=c(t.suffix);if(i.suffix=L,t.avow){var O=l.vowel[t.avow];s("Avow",O,"Stack",d,"Res",i),t.suffix==l.a&&(i.vow=null,d.push(i.suffix.trl),d.push(O.descr),d.push(O.trl),"i"==O.trl?i.suffix.trl="ä:":i.suffix.trl=O.trl),s("Stack2",d),s("PRETTY",a(i))}else{var S=[L.trl,"a"].join("");if(l.kanapamara.includes(t.suffix));else if(l.tanalasa.includes(t.suffix))i.vow.trl=l.umlaut[i.vow.trl]||i.vow.trl;else{if(l.a!=t.suffix)return"IMPOSSIBLE SUFFIX";S=L.trl}d.push(S)}if(l.tasa.includes(t.suffix)&&(i.suffix=null),t.secsuf){var j=l.letter[t.secsuf],R=[j.trl,"a"].join("");d.push(R)}d.push(a(i))}var k=e?d.join("-"):a(i);return t.quest&&(k=[k,t.quest.trl].join("")),k=k.replace("aa","a").replace("aä","ä")}(function(t){var e,n=void 0,r=t.tib,i=void 0,s=void 0,a=void 0,c=[],d=void 0,u=void 0,p=void 0,f=[],h=void 0,v=o.default.last(r),g=r[r.length-2];e=v,o.default.keys(l.vowel).includes(e)?l.a==g&&(p=v,r.pop()):g==l.a&&v==l.maa[0]&&(r.pop(),r.pop(),h={trl:"am"});var m=o.default.intersection(r,o.default.keys(l.vowel)),w=void 0,x=void 0;if(1==m.length)w=m[0],x=r.indexOf(w);else if(m.length>1)return{errs:["TOO MANY VOWELS"]};var b=r.includes(l.wasur),y=o.default.intersection(r,o.default.keys(l.lower)),C=o.default.intersection(r,l.yaralaa),E=void 0,L=void 0;if(1==C.length&&(E=C[0],L=r.indexOf(E)),b){var O=r.indexOf(l.wasur);n="wasur",i=r[O-1],s=r[O-2],f=r.slice(O+1)}else if(y.length){n=1;var S=y[0],j=r.indexOf(S);if(c=r.slice(0,j),w&&E)n="vow&&sub",E=r[x-1],i=r[x-2],c=r.slice(0,x-2),f=r.slice(x+1);else if(w)n=3,i=r[x-1],c=r.slice(0,x-1),f=r.slice(x+1);else if(E)n="sub",i=r[L-1],c=r.slice(0,L-1),f=r.slice(L+1);else{n=4;var R=y.slice(-1)[0],k=r.indexOf(R);i=r[k],c=r.slice(0,k),f=r.slice(k+1)}}else if(E)n=8,i=r[L-1],c=r.slice(0,L-1),f=w?r.slice(x+1):r.slice(L+1),l.a;else if(w)n=5,i=r[x-1],c=r.slice(0,x-1),f=r.slice(x+1),l.a;else{if(n=6,r.length>4)throw new Error("TOO MANY SYMS IN PLAIN WF");1==r.length?i=r[0]:2==r.length?(n=7,i=r[0],d=r[1]):3!=r.length&&4!=r.length||(n=9,s=r[0],i=r[1],f=r.slice(2))}c&&c.length&&(2==c.length?(s=c[0],l.ralasa.includes(c[1])&&(a=c[1])):c&&1==c.length&&(l.ralasa.includes(c[0])?a=c[0]:s=c[0])),f&&f.length&&(2==f.length?(d=f[0],u=f[1]):1==f.length&&(d=f[0]));var N={point:n,prefix:s,superfix:a,main:i,subfix:E,vow:w,suffix:d,secsuf:u,errs:[],syms:r};for(var q in b&&(N.wasur=!0),p&&(N.avow=p),h&&(N.quest=h),N)N[q]||delete N[q];return c&&c.length>2&&N.errs.push("TOO MANY PREFS"),C.length>1&&N.errs.push("TOO MANY SUBFIXES"),f.length>2&&N.errs.push("TOO MANY SUFFIXES"),i||N.errs.push("NO MAIN!"),N}(t),e);n.push(i)}else n.push(t.space)}),n.join("")};var r,i=n(1),o=(r=i)&&r.__esModule?r:{default:r},l=n(25);console.log;var s=n(5)("app");function a(t){t.vow||(t.vow={trl:"a"});var e=t.main.trl;return e=[e,t.vow.trl].join(""),t.suffix&&(e=[e,t.suffix.trl].join("")),e}function c(t){var e=l.letter[t];return e?o.default.clone(e):{trl:t}}},function(t,e){t.exports=require("electron-clipboard-extended")},function(t,e){t.exports=require("slash")},,function(t,e){t.exports=require("split.js")},,,,,,,,,,function(t,e){t.exports=require("util")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.tsek="་",e.shad="།",e.ralasa=["ར","ལ","ས"],e.kanatanapamaaralasa=["ག","ང","ད","ན","བ","མ","འ","ར","ལ","ས"],e.kanapamara=["ག","ང","བ","མ","ར"],e.tanalasa=["ད","ན","ལ","ས"],e.tasa=["ད","ས"],e.sa=["ས"],e.maa=["མ","འ"],e.a="འ",e.sama=["ས","མ"],e.la=["ལ"],e.yaralaa=["ྱ","ྲ","ླ","ྰ"],e.wasur="ྭ",e.umlaut={a:"ä",u:"ü",o:"ö"},e.voiced={1:"g",2:"j",3:"d",4:"b",5:"dz"},e.nasalHigh={1:"ŋ",2:"ñ",3:"n",4:"m"},e.up2rows={1:"c",2:"cʰ",3:"c̣ʰ",4:"ṇ̃"};var r=e.letter={},i=e.lower={},o=e.vowel={};i["ྐ"]={trl:"k",row:1,col:1},i["ྑ"]={trl:"kʰ",row:1,col:2},i["ྒ"]={trl:"ḳʰ",row:1,col:3},i["ྔ"]={trl:"ŋ",row:1,col:4},i["ྕ"]={trl:"c",row:2,col:1},i["ྖ"]={trl:"cʰ",row:2,col:2},i["ྗ"]={trl:"c̣ʰ",row:2,col:3},i["ྙ"]={trl:"ṇ̃",row:2,col:4},i["ྟ"]={trl:"t",row:3,col:1},i["ྠ"]={trl:"tʰ",row:3,col:2},i["ྡ"]={trl:"ṭʰ",row:3,col:3},i["ྣ"]={trl:"n",row:3,col:4},i["ྤ"]={trl:"p",row:4,col:1},i["ྥ"]={trl:"pʰ",row:4,col:2},i["ྦ"]={trl:"p̣ʰ",row:4,col:3},i["ྨ"]={trl:"ṃ",row:4,col:4},i["ྩ"]={trl:"ç",row:5,col:1},i["ྪ"]={trl:"çʰ",row:5,col:2},i["ྫ"]={trl:"ç̣ʰ",row:5,col:3},i["ྱ"]={trl:"y",row:6,col:4},i["ྲ"]={trl:"r",row:7,col:1},i["ླ"]={trl:"l",row:7,col:2},i["ྷ"]={trl:"h",row:8,col:1},i[""]={trl:"",row:1,col:1},i[""]={trl:"",row:1,col:1},r["ཀ"]={trl:"k",row:1,col:1},r["ཁ"]={trl:"kʰ",row:1,col:2},r["ག"]={trl:"ḳʰ",row:1,col:3},r["ང"]={trl:"ŋ",row:1,col:4},r["ཅ"]={trl:"c",row:2,col:1},r["ཆ"]={trl:"cʰ",row:2,col:2},r["ཇ"]={trl:"c̣ʰ",row:2,col:3},r["ཉ"]={trl:"ñ",row:2,col:4},r["ཏ"]={trl:"t",row:3,col:1},r["ཐ"]={trl:"tʰ",row:3,col:2},r["ད"]={trl:"ṭʰ",row:3,col:3},r["ན"]={trl:"n",row:3,col:4},r["པ"]={trl:"p",row:4,col:1},r["ཕ"]={trl:"pʰ",row:4,col:2},r["བ"]={trl:"p̣ʰ",row:4,col:3},r["མ"]={trl:"m",row:4,col:4},r["ཙ"]={trl:"ç",row:5,col:1},r["ཚ"]={trl:"çʰ",row:5,col:2},r["ཛ"]={trl:"ç̣ʰ",row:5,col:3},r["ཝ"]={trl:"w",row:5,col:4},r["ཞ"]={trl:"ṣ̂",row:6,col:1},r["ཟ"]={trl:"ṣ",row:6,col:2},r["འ"]={trl:"a",row:6,col:3},r["ཡ"]={trl:"y",row:6,col:4},r["ར"]={trl:"r",row:7,col:1},r["ལ"]={trl:"l",row:7,col:2},r["ཤ"]={trl:"ŝ",row:7,col:3},r["ས"]={trl:"s",row:7,col:4},r["ཧ"]={trl:"h",row:8,col:1},r["ཨ"]={trl:"a",row:8,col:2},o["ཱ"]={trl:"a",descr:"a-chung"},o["ི"]={trl:"i",descr:"kiku"},o["ུ"]={trl:"u",descr:"ŝapkyu"},o["ོ"]={trl:"o",descr:"naro"},o["ེ"]={trl:"e",descr:"ḋeŋbu"}},function(t,e){t.exports=require("pouchdb-authentication")},function(t,e){t.exports=require("mousetrap")},function(t,e){t.exports=require("json5")},function(t,e){t.exports=require("axios")},,function(t,e,n){"use strict";n.r(e);var r=n(1),i=n.n(r),o=n(0);n(24);function l(t){return document.querySelector(t)}function s(t){return document.querySelectorAll(t)}function a(t,e){let n=document.createElement(t);return e&&n.classList.add(e),n}function c(t,e){let n=document.createElement("span");return n.textContent=t,e&&n.classList.add(e),n}function d(t){if(t)for(;t.hasChildNodes();)t.removeChild(t.lastChild)}function u(t){return t.getBoundingClientRect()}function p(t,e){let n=[t.top,"px"].join(""),r=[t.left,"px"].join("");e.style.top=n,e.style.left=r}function f(){return[].slice.call(document.querySelectorAll(":hover")).pop()}var h=n(14),v=n.n(h),g=n(10),m=n.n(g),w=n(2);const x=n(0).remote.require("electron-settings");let b=w.b.tsek;const y=console.log;function C(t){let e=t.pars,n=l("#source"),r=l("#result");d(n),d(r),e.forEach(t=>{let e=function(t,e){let n=document.createElement("p");return n.textContent=t,e&&n.classList.add(e),n}();e.classList.add("tibpar"),t.forEach(t=>{let n=c(t.text);t.lang?n.classList.add("tibphrase"):t.punct?n.classList.add("punct"):n.classList.add("space"),e.appendChild(n)}),n.appendChild(e)});s("span.tibetan")}function E(t,e){let n=u(t),r=e?m()(t.textContent,!0):m()(t.textContent),i={top:n.top-40,left:n.left+15},o=l("#transcript");o.textContent=r,o.classList.remove("is-hidden"),p(i,o)}function L(t,e){let n;try{n=JSON.parse(t.dataset.chains)}catch(e){return void y("ERR: JSON chains",t)}let r=!t.closest(".tibpar"),i=function(t,e){let n;e?((n=a("div","popup")).classList.add("upper"),document.body.appendChild(n)):n=l("#ambi");let r=u(t);d(n),n.classList.remove("is-hidden"),p({top:r.bottom-3,left:r.left},n);let i=a("ul","ambilist");return n.appendChild(i),i}(t,r);e?function(t,e){e.forEach(e=>{let n,r=a("li","ambiline");t.appendChild(r),e.ambi?(n=c(e.seg,"tibambi")).dataset.chains=JSON.stringify(e.chains):e.docs.length?(n=c(e.seg,"tibwf")).dataset.docs=JSON.stringify(e.docs):n=c(e.seg,"tibphrase"),r.appendChild(n)})}(i,n):function(t,e){t.classList.add("danger"),e.forEach(e=>{let n=a("li","ambiline");t.appendChild(n),e.forEach(t=>{let e=t.docs.length?c(t.seg,"tibwf"):c(t.seg,"tibphrase");t.docs.length&&(e.dataset.docs=JSON.stringify(t.docs)),n.appendChild(e)})})}(i,n)}function O(t,e){l("#progress").classList.remove("is-hidden");let n=t.textContent.trim(),r=new RegExp(b+"$"),s={str:n.replace(r,""),compound:e,lastsek:i.a.last(n)==b};o.ipcRenderer.send("queryDBs",s)}o.ipcRenderer.on("replayDBs",function(t,e){l("#progress").classList.add("is-hidden");let n=e.chain,r=f();n&&(e.compound?(r.dataset.chains=JSON.stringify(n),L(r,!0)):function(t,e,n){t&&(t.textContent="",e.forEach((n,r)=>{let i;n.ambi?(i=c(n.seg,"tibambi")).dataset.chains=JSON.stringify(n.chains):n.docs.length?(i=c(n.seg,"tibwf")).dataset.docs=JSON.stringify(n.docs):i=c(n.seg,"tibphrase"),t.appendChild(i),r<e.length-1&&t.appendChild(c(b,"tsek"))}),n&&t.appendChild(c(b,"tsek")))}(r,n,e.lastsek))});console.log;const S=n(6);function j(t){let e=l("#cloneERR"),n=l("#progress");t?n.classList.add("is-hidden"):e.classList.remove("is-hidden")}function R(){let t=S.get("cfg"),e=t.map(t=>t.name),n=l("#adictmessage");e.length&&(n.textContent="click dict's name to move it first");let r=l("#local-dicts-table tbody");d(r),t.forEach(t=>{let e=t.dname,n=a("tr");r.appendChild(n);let o=a("td","dictname");n.appendChild(o),o.textContent=i.a.capitalize(e),o.dataset.firstdict=e;let l=a("td","active-dict");if(t.active){let t=k();l.appendChild(t)}else l.textContent="activate";l.dataset.activedict=e,n.appendChild(l);let s=a("td","dictcsv");s.textContent="toCSV",s.dataset.csv=e,n.appendChild(s)})}function k(){let t=a("img","dict-check");return t.setAttribute("src","../resources/check.png"),t}o.ipcRenderer.on("remoteDictsReply",function(t,e){j(e),function(t){let e=S.get("cfg"),n=["_users"],r=e.map(t=>t.dname),o=i.a.uniq(n.concat(r)),s=l("#server-dicts-table tbody");d(s),t.forEach(t=>{if(n.includes(t.dname))return;let e=a("tr");s.appendChild(e);let r=a("td");e.appendChild(r),r.textContent=i.a.capitalize(t.dname);let l=a("td","dsize");l.textContent=i.a.capitalize(t.size),e.appendChild(l);let c=a("td","link");if(o.includes(t.dname)){let t=k();c.appendChild(t)}else c.textContent="sync";c.dataset.clone=t.dname,e.appendChild(c)})}(e)}),o.ipcRenderer.on("replicateReply",function(t,e){j(e);F({section:"activedicts"})}),o.ipcRenderer.on("csvReply",function(t,e){j(e);F({section:"activedicts"})}),o.ipcRenderer.on("cleanupReply",function(t,e){j(e);F({section:"clonedicts"})});const N=n(3),q=(n(6),console.log),P=n(9);P.plugin(n(26));const A=o.remote.app,M=(A.getAppPath(),A.getPath("userData")),_=console.log,z=(n(11),n(0).remote.require("electron-settings")),T=n(27),{getCurrentWindow:D}=(n(3),n(12),n(0).remote);let J,I=[],B=0;function F(t){try{t=JSON.parse(JSON.stringify(t))}catch(e){_("NAV-state ERR",e),t={}}let e=t.section||"home";e||(t.section="home"),function(t){K();const e=["#",t].join("");l(e).classList.remove("is-hidden"),l(e).classList.add("is-shown")}(t.section),t.old||(t.old=!1,delete t.old,I.push(t),B=I.length-1),"main"==e?(function(t){let e=z.get("split-sizes")||[50,50];J&&t.mono?J.collapse(1):J&&J.setSizes(e),J||(z.set("split-sizes",e),J=v()(["#source","#result"],{sizes:e,gutterSize:5,cursor:"col-resize",minSize:[0,0],onDragEnd:function(t){z.set("split-sizes",t),D().reload()}}),t.mono&&J.collapse(1),document.addEventListener("keydown",function(t){},!1),document.addEventListener("wheel",function(t){},!1))}(t),C(t)):"clonedicts"==e?o.ipcRenderer.send("remoteDicts",""):"activedicts"==e&&R(),l("#progress").classList.add("is-hidden"),z.set("state",t)}function K(){const t=s(".section");Array.prototype.forEach.call(t,t=>{t.classList.add("is-hidden"),t.classList.remove("is-shown")}),l("#transcript").classList.add("is-hidden"),l("#ambi").classList.add("is-hidden")}T.bind(["alt+left","alt+right"],function(t){37==t.which?function(){if(B<=0)return;B--;let t=I[B];t.old=!0,K(),F(t)}():39==t.which&&function(){if(B>=I.length-1)return;B++;let t=I[B];t.old=!0,K(),F(t)}()}),T.bind(["alt+1","alt+2"],function(t){}),T.bind(["esc"],function(t){}),T.bind(["ctrl+d"],function(t){o.ipcRenderer.send("queryLocalDict","/home/michael/diglossa.texts/Tibetan")}),T.bind(["ctrl+j"],function(t){let e="/home/michael/tibetan/utils/csv/csvdict.json";_("IMPORT",e),o.ipcRenderer.send("importcsv",e)}),T.bind(["ctrl+i"],function(t){o.ipcRenderer.send("infoDB","csvdict")}),T.bind(["ctrl+v"],function(t){o.ipcRenderer.send("infoDB","vasilyev")}),T.bind(["ctrl+u"],function(t){_("CLICK SIGNUP"),function(t){let e=new P("http://localhost:5984/mydb",{skip_setup:!0}),n=N.resolve(t,"pouch","auth");new P(n).sync(e,{live:!0,retry:!0}).on("error",console.log.bind(console)),e.signUp("batman","brucewayne",function(t,e){t&&("conflict"===t.name||t.name)}).then(function(t){q("SIGNUP RES",t)})}(M)});var Y=n(4),U=n.n(Y);n.d(e,"scrollPane",function(){return tt});const W=n(0).remote.require("electron-settings"),H=(n(28),n(29)),V=(n(12),console.log),X=(n(3),n(11)),{dialog:G,getCurrentWindow:$}=n(0).remote;n(8);l("#new-version");let Q=l("#container");s('link[rel="import"]').forEach(t=>{let e=t.import.querySelector(".section");Q.appendChild(e.cloneNode(!0))}),o.ipcRenderer.on("version",function(t,e){H.get("https://api.github.com/repos/mbykov/pecha.js/releases/latest").then(function(t){if(!t||!t.data)return;let n=t.data.name;if(e&&n&&n>e){let t=l("#new-version"),e=["new version available:",n].join(" ");t.textContent=e,t.classList.remove("is-hidden")}}).catch(function(t){console.log("API ERR")})}),o.ipcRenderer.on("section",function(t,e){F({section:e})}),o.ipcRenderer.on("reread",function(t){let e=W.get("state");$().reload(),F(e)});let Z=W.get("state");function tt(t,e){if(1==t.shiftKey)return;let n=t.deltaY>0?24:-24,r=l(".section.is-shown");r&&(r.scrollTop+=n)}function et(t){V("FNS",t)}function nt(t){if(!t)return;let e=t[0];e&&o.ipcRenderer.send("import-from-csv",e)}Z||(Z={section:"home"}),F(Z),document.addEventListener("click",t=>{let e=l("#progress"),n=t.target.dataset;if(!n)return;let r=t.target.parentElement;if(t.target.classList.contains("external")){let e=t.target.textContent;o.shell.openExternal(e)}else n.section?F({section:n.section}):n.clone?(e.classList.remove("is-hidden"),o.ipcRenderer.send("replicate",n.clone)):n.firstdict?function(t){let e=S.get("cfg"),n=i.a.find(e,e=>e.dname==t),r=i.a.reject(e,e=>e.dname==t);r.unshift(n),(e=r).forEach((t,e)=>{t.idx=e}),S.set("cfg",e),R()}(n.firstdict):n.activedict?function(t){let e=S.get("cfg"),n=i.a.find(e,e=>e.dname==t.dataset.activedict),r=k();t.textContent?(t.textContent="",t.appendChild(r),n.active=!0):(d(t),t.textContent="activate",n.active=!1),S.set("cfg",e)}(t.target):n.csv?(e.classList.remove("is-hidden"),o.ipcRenderer.send("export-to-csv",n.csv)):r&&r.dataset&&r.dataset.activedict||("cleanupdb"==t.target.id?o.ipcRenderer.send("cleanupDB"):"scandir"==t.target.id?G.showOpenDialog({properties:["openDirectory"]},et):"importcsv"==t.target.id?G.showOpenDialog({properties:["openFile"],filters:[{name:"JSON",extensions:["json"]}]},nt):n.docs&&O(t.target,!0))}),document.addEventListener("mouseover",function(t){if(!t.target.textContent)return;if(1==t.ctrlKey)return;t.target.closest(".tibpar")&&s(".popup").forEach(t=>{t.classList.add("is-hidden")}),t.target.classList.contains("tibphrase")?1==t.shiftKey||O(t.target):t.target.classList.contains("tibwf")?function(t){l("#source");let e=l("#result");d(e);let n=t.textContent,r=JSON.parse(t.dataset.docs);try{r=JSON.parse(t.dataset.docs)}catch(t){return void y("ERR: JSON docs",t)}let o=x.get("cfg");r.forEach(t=>{t.weight=i.a.find(o,e=>t.dname==e.dname).idx}),r=i.a.sortBy(r,"weight");let s=a("div","dict");e.appendChild(s);let c=a("p","dict-wf");c.textContent=n,s.appendChild(c),r.forEach(t=>{let e=a("p","dict-dname");e.textContent=t.dname,s.appendChild(e);let n=a("p","dict-article");n.textContent=t.dict,s.appendChild(n);let r=a("ul","dict-ul");s.appendChild(r),t.trns||y("NO TRNS",t),t.trns&&t.trns.forEach(t=>{let e=a("li","dict-line");e.textContent=t,r.appendChild(e)})})}(t.target):t.target.classList.contains("tibambi")&&L(t.target)},!1),document.addEventListener("mouseleave",function(t){if(t.target.classList&&1!=t.ctrlKey&&t.target.classList.contains("tibphrase")){l("#transcript").classList.add("is-hidden")}},!1),document.addEventListener("keyup",function(t){if(1==t.ctrlKey)return;l("#transcript").classList.add("is-hidden")},!1),document.addEventListener("keydown",function(t){if(1!=t.shiftKey)return;let e=f();if(!e)return;"source"==e.id&&(e=l(".tibpar"));let n=e.textContent;U()(n,"tib")&&(E(e),1==t.ctrlKey&&E(e,!0))},!1),document.addEventListener("wheel",function(t){tt(t,Z)},!1),X.on("text-changed",()=>{let t=X.readText(),e=U()(t,"tib");e&&e.length&&F({section:"main",pars:e})}).startWatching()}]);
//# sourceMappingURL=app.js.map